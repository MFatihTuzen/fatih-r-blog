<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="M. Fatih Tüzen">
<meta name="dcterms.date" content="2025-08-18">

<title>Handling Missing Data in R: A Comprehensive Guide – A Statistician’s R Notebook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-f3c2ea88cadbcfb37ba28ffa2c97cfc1.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-ae2d0dcda2edce4ab590422bb373b64f.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">A Statistician’s R Notebook</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/MFatihTuzen"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/dr-m-fatih-t-2b2a4328/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blogroll" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">BlogRoll</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-blogroll">    
        <li>
    <a class="dropdown-item" href="https://www.r-bloggers.com/">
 <span class="dropdown-text">R-bloggers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://community.rstudio.com/">
 <span class="dropdown-text">R-Studio Community</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rweekly.org/">
 <span class="dropdown-text">R weekly</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://allisonhorst.com/allison-horst">
 <span class="dropdown-text">Allison Horst</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/topics/r">
 <span class="dropdown-text">Github R Topics</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Handling Missing Data in R: A Comprehensive Guide</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">Statistics</div>
                <div class="quarto-category">Data Analysis</div>
                <div class="quarto-category">Data Science</div>
                <div class="quarto-category">Data Preprocessing</div>
                <div class="quarto-category">Missing Data</div>
                <div class="quarto-category">Data Cleaning</div>
                <div class="quarto-category">Imputation</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>M. Fatih Tüzen </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 18, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#nhanes-dataset" id="toc-nhanes-dataset" class="nav-link" data-scroll-target="#nhanes-dataset"><span class="header-section-number">2</span> NHANES Dataset</a></li>
  <li><a href="#why-missingness-matters" id="toc-why-missingness-matters" class="nav-link" data-scroll-target="#why-missingness-matters"><span class="header-section-number">3</span> Why Missingness Matters</a></li>
  <li><a href="#missing-data-mechanisms" id="toc-missing-data-mechanisms" class="nav-link" data-scroll-target="#missing-data-mechanisms"><span class="header-section-number">4</span> Missing Data Mechanisms</a></li>
  <li><a href="#detecting-missing-data" id="toc-detecting-missing-data" class="nav-link" data-scroll-target="#detecting-missing-data"><span class="header-section-number">5</span> Detecting Missing Data</a></li>
  <li><a href="#handling-missing-data-methods" id="toc-handling-missing-data-methods" class="nav-link" data-scroll-target="#handling-missing-data-methods"><span class="header-section-number">6</span> Handling Missing Data — Methods</a></li>
  <li><a href="#single-vs.-multiple-imputation" id="toc-single-vs.-multiple-imputation" class="nav-link" data-scroll-target="#single-vs.-multiple-imputation"><span class="header-section-number">7</span> Single vs.&nbsp;Multiple Imputation</a></li>
  <li><a href="#comparison-of-common-imputation-methods" id="toc-comparison-of-common-imputation-methods" class="nav-link" data-scroll-target="#comparison-of-common-imputation-methods"><span class="header-section-number">8</span> Comparison of Common Imputation Methods</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">9</span> Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">10</span> References</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="missing_values.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Data preprocessing is a cornerstone of any data analysis or machine learning pipeline. Raw data rarely comes in a form ready for direct analysis — it often requires cleaning, transformation, normalization, and careful handling of anomalies. Among these preprocessing tasks, dealing with missing data stands out as one of the most critical and unavoidable challenges.</p>
<p>Missing values appear in virtually every domain: surveys may have skipped questions, administrative registers might contain incomplete records, and clinical trials can suffer from dropout patients. Ignoring these gaps or handling them naively does not just reduce the amount of usable information; it can also introduce bias, decrease statistical power, and ultimately compromise the validity of conclusions. In other words, missing data is not just an inconvenience — it is a methodological problem that demands rigorous attention.</p>
<p>In statistical practice, missingness is often represented as <code>NA</code> (Not Available) in R. However, not all missing values are created equal. Some are missing completely at random, others depend on observed variables, and in some cases, the missingness itself carries meaningful information. Understanding these mechanisms is essential before deciding how to address them. This makes missing data imputation a fundamental part of the broader data preprocessing workflow, alongside tasks such as outlier detection, data normalization, and feature engineering.</p>
<p>In this article, we will cover:</p>
<ul>
<li>The theoretical foundations of missing data mechanisms (MCAR, MAR, MNAR).</li>
<li>How to detect and visualize missing values in R.</li>
<li>Different strategies for handling missingness, from simple imputation to advanced multiple imputation techniques.</li>
<li>A practical workflow using the NHANES dataset, widely used in health research, to demonstrate methods in R.</li>
<li>Best practices, pitfalls, and recommendations for applied data science.</li>
</ul>
<p>We will use several R packages throughout this tutorial:</p>
<ul>
<li><strong>tidyverse</strong>: Data wrangling and visualization</li>
<li><strong>naniar</strong> and <strong>VIM</strong>: Tools for exploring and visualizing missing data</li>
<li><strong>mice</strong>: Multiple imputation by chained equations</li>
<li><strong>missForest</strong>: Random forest–based imputation for nonlinear data</li>
</ul>
<p>By integrating missing data handling into the larger context of preprocessing, this structured approach will not only help you manage incomplete datasets effectively but also ensure that your entire analytical workflow remains <strong>robust, transparent, and reliable</strong>.</p>
</section>
<section id="nhanes-dataset" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="nhanes-dataset"><span class="header-section-number">2</span> NHANES Dataset</h2>
<p>In this section, we will work with the <strong>NHANES</strong> dataset, which comes from the US National Health and Nutrition Examination Survey.<br>
The dataset includes demographic, examination, and laboratory data collected from thousands of individuals.<br>
Since the full dataset is quite large, we will focus only on a subset of variables that are relevant for preprocessing examples.</p>
<p>Here are the variables we will use:</p>
<ul>
<li><strong>ID</strong>: Unique identifier for each participant</li>
<li><strong>Age</strong>: Age of the participant</li>
<li><strong>Gender</strong>: Biological sex (male or female)</li>
<li><strong>BMI</strong>: Body Mass Index</li>
<li><strong>BPSysAve</strong>: Average systolic blood pressure</li>
<li><strong>Diabetes</strong>: Whether the participant has been diagnosed with diabetes</li>
</ul>
<p>Before diving into preprocessing, let’s take a quick look at the structure of these selected variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NHANES)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"NHANES"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Select relevant variables</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>nhanes_sub <span class="ot">&lt;-</span> NHANES <span class="sc">|&gt;</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Age, Gender, BMI, BPSysAve, Diabetes)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(nhanes_sub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 10,000
Columns: 6
$ ID       &lt;int&gt; 51624, 51624, 51624, 51625, 51630, 51638, 51646, 51647, 51647…
$ Age      &lt;int&gt; 34, 34, 34, 4, 49, 9, 8, 45, 45, 45, 66, 58, 54, 10, 58, 50, …
$ Gender   &lt;fct&gt; male, male, male, male, female, male, male, female, female, f…
$ BMI      &lt;dbl&gt; 32.22, 32.22, 32.22, 15.30, 30.57, 16.82, 20.64, 27.24, 27.24…
$ BPSysAve &lt;int&gt; 113, 113, 113, NA, 112, 86, 107, 118, 118, 118, 111, 104, 134…
$ Diabetes &lt;fct&gt; No, No, No, No, No, No, No, No, No, No, No, No, No, No, No, N…</code></pre>
</div>
</div>
</section>
<section id="why-missingness-matters" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="why-missingness-matters"><span class="header-section-number">3</span> Why Missingness Matters</h2>
<p>Missing data is not just an inconvenience — it can distort the statistical conclusions we draw from a dataset.<br>
There are several critical reasons why handling missingness properly is essential:</p>
<ul>
<li><strong>Biased results</strong>: If the missing values are not random, analyses may systematically misrepresent the population.</li>
<li><strong>Reduced sample size</strong>: Complete-case analysis (simply dropping missing rows) reduces data availability, weakening statistical power.</li>
<li><strong>Model incompatibility</strong>: Many modeling techniques in R (e.g., <code>lm()</code>, <code>glm()</code>) require complete data, and will automatically drop cases with missing values, sometimes silently.</li>
</ul>
<section id="a-short-case-example-bmi-missingness-and-blood-pressure" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="a-short-case-example-bmi-missingness-and-blood-pressure"><span class="header-section-number">3.1</span> A Short Case Example: BMI Missingness and Blood Pressure</h3>
<p>Suppose we want to explore how <strong>Body Mass Index (BMI)</strong> relates to <strong>Systolic Blood Pressure (BPSysAve)</strong>.<br>
However, BMI contains missing values. If we ignore them and only analyze complete cases, we may end up with biased conclusions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many missing in BMI?</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(nhanes_sub<span class="sc">$</span>BMI))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 366</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete-case dataset (dropping missing BMI)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>nhanes_complete <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(BMI))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare sample sizes</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(nhanes_sub)     <span class="co"># original sample size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(nhanes_complete) <span class="co"># after dropping missing BMI</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9634</code></pre>
</div>
</div>
<p>We see that a substantial portion of the data is dropped when we remove missing BMI values. This reduction not only decreases efficiency but can also <strong>bias the estimates</strong> if those missing values are not randomly distributed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression with complete cases only</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>model_complete <span class="ot">&lt;-</span> <span class="fu">lm</span>(BPSysAve <span class="sc">~</span> BMI <span class="sc">+</span> Age <span class="sc">+</span> Gender, <span class="at">data =</span> nhanes_complete)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_complete)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BPSysAve ~ BMI + Age + Gender, data = nhanes_complete)

Residuals:
    Min      1Q  Median      3Q     Max 
-56.281  -8.652  -0.955   7.560 102.790 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 90.016503   0.677618  132.84   &lt;2e-16 ***
BMI          0.328076   0.023228   14.12   &lt;2e-16 ***
Age          0.412758   0.008076   51.11   &lt;2e-16 ***
Gendermale   4.346847   0.313476   13.87   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.43 on 8483 degrees of freedom
  (1147 observations deleted due to missingness)
Multiple R-squared:  0.2969,    Adjusted R-squared:  0.2966 
F-statistic:  1194 on 3 and 8483 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>The model only uses complete cases, ignoring potentially informative missingness.</li>
<li>If BMI is more often missing in certain subgroups (e.g., older adults or females), then the relationship estimated here does not represent the whole population.</li>
<li>In later sections, we will see how different imputation strategies can mitigate this problem.</li>
</ul>
</section>
</section>
<section id="missing-data-mechanisms" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="missing-data-mechanisms"><span class="header-section-number">4</span> Missing Data Mechanisms</h2>
<p>One of the most crucial aspects of handling missing data is to understand <strong>why</strong> the data are missing.<br>
The mechanism behind missingness determines whether our chosen method will yield unbiased and efficient estimates.</p>
<section id="types-of-missing-data-mechanisms" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="types-of-missing-data-mechanisms"><span class="header-section-number">4.1</span> Types of Missing Data Mechanisms</h3>
<ul>
<li><p><strong>MCAR (Missing Completely At Random)</strong><br>
The probability of a value being missing does not depend on either the observed or the unobserved data.<br>
→ Example: A lab machine randomly fails for some patients, regardless of their characteristics.<br>
→ Implication: Complete-case analysis is valid (though less efficient).</p></li>
<li><p><strong>MAR (Missing At Random)</strong><br>
The probability of missingness depends only on the <strong>observed</strong> data, not on the missing values themselves.<br>
→ Example: People with lower income are less likely to report their weight, but we observe income.<br>
→ Implication: Multiple imputation or likelihood-based methods can recover unbiased estimates.</p></li>
<li><p><strong>MNAR (Missing Not At Random)</strong><br>
The probability of missingness depends on the <strong>unobserved</strong> value itself.<br>
→ Example: People with higher BMI are less likely to report their weight.<br>
→ Implication: Strong assumptions or external information are needed; imputation under MAR will still be biased.</p></li>
</ul>
</section>
<section id="what-each-mechanism-implies-with-nhanes-intuition" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="what-each-mechanism-implies-with-nhanes-intuition"><span class="header-section-number">4.2</span> What each mechanism implies (with NHANES intuition)</h3>
<ul>
<li><p><strong>MCAR</strong> — e.g., random device failure that occasionally prevents recording <code>BMI</code>.<br>
<em>Implication:</em> Complete-case analysis (dropping rows) is unbiased but wastes data.</p></li>
<li><p><strong>MAR</strong> — e.g., <code>BMI</code> missingness varies by observed <strong>Age</strong> or <strong>Gender</strong>.<br>
<em>Implication:</em> Likelihood-based methods or <strong>Multiple Imputation (MI)</strong> are valid if those predictors are in the imputation model.</p></li>
<li><p><strong>MNAR</strong> — e.g., people with <strong>very high BMI</strong> systematically do not report it.<br>
<em>Implication:</em> MAR-based methods still biased; requires <strong>sensitivity analysis</strong> or explicit MNAR models.</p></li>
</ul>
</section>
<section id="quick-nhanes-checks-that-suggest-a-mechanism" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="quick-nhanes-checks-that-suggest-a-mechanism"><span class="header-section-number">4.3</span> Quick NHANES checks that suggest a mechanism</h3>
<p>Below we do two simple diagnostics on our working subset <code>nhanes_sub</code><br>
(defined earlier as: <code>NHANES |&gt; select(ID, Age, Gender, BMI, BPSysAve, Diabetes)</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages we already use</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Overall BMI missingness</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>nhanes_sub <span class="sc">|&gt;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pct_missing_BMI =</span> <span class="fu">mean</span>(<span class="fu">is.na</span>(BMI)) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_missing_BMI =</span> <span class="fu">round</span>(pct_missing_BMI, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Overall BMI missingness (%)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Overall BMI missingness (%)</caption>
<thead>
<tr class="header">
<th style="text-align: right;">pct_missing_BMI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3.7</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Does BMI missingness vary by observed variables? (MAR hint)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#    - By Gender</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>by_gender <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Gender) <span class="sc">|&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pct_miss_BMI =</span> <span class="fu">mean</span>(<span class="fu">is.na</span>(BMI)) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_miss_BMI =</span> <span class="fu">round</span>(pct_miss_BMI, <span class="dv">1</span>))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#    - By Age groups (bins)</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>by_age <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AgeBand =</span> <span class="fu">cut</span>(Age, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">60</span>, <span class="cn">Inf</span>),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;=30"</span>, <span class="st">"31–45"</span>, <span class="st">"46–60"</span>, <span class="st">"60+"</span>),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">right =</span> <span class="cn">FALSE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(AgeBand) <span class="sc">|&gt;</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pct_miss_BMI =</span> <span class="fu">mean</span>(<span class="fu">is.na</span>(BMI)) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_miss_BMI =</span> <span class="fu">round</span>(pct_miss_BMI, <span class="dv">1</span>))</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Show summaries nicely</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(by_gender, <span class="at">caption =</span> <span class="st">"BMI missingness by Gender (%)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>BMI missingness by Gender (%)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Gender</th>
<th style="text-align: right;">pct_miss_BMI</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">5020</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">4980</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(by_age,    <span class="at">caption =</span> <span class="st">"BMI missingness by Age band (%)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>BMI missingness by Age band (%)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">AgeBand</th>
<th style="text-align: right;">pct_miss_BMI</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">&lt;=30</td>
<td style="text-align: right;">7.6</td>
<td style="text-align: right;">4121</td>
</tr>
<tr class="even">
<td style="text-align: left;">31–45</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">2049</td>
</tr>
<tr class="odd">
<td style="text-align: left;">46–60</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">1991</td>
</tr>
<tr class="even">
<td style="text-align: left;">60+</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">1839</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>If <code>pct_miss_BMI</code> is <strong>similar across groups</strong>, MCAR is more plausible.</p></li>
<li><p>If missingness <strong>changes with Age or Gender</strong>, <strong>MAR</strong> is more plausible (we must include those predictors in imputation).</p></li>
<li><p>These are <em>indicators</em>, not proofs; true <strong>MNAR</strong> needs external info or sensitivity analyses.</p></li>
</ul>
<p><strong>Which methods are valid under which mechanism?</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 25%">
<col style="width: 28%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>Mechanism</th>
<th>Example (NHANES context)</th>
<th>Valid methods</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>MCAR</strong></td>
<td>Random loss of <code>BMI</code> records</td>
<td>Complete-case, single imputation, MI</td>
<td>Unbiased but may waste data</td>
</tr>
<tr class="even">
<td><strong>MAR</strong></td>
<td><code>BMI</code> missingness varies by observed <code>Age</code>, <code>Gender</code></td>
<td><strong>Multiple Imputation (MICE)</strong>, likelihood/EM, missForest</td>
<td>Include strong predictors of missingness</td>
</tr>
<tr class="odd">
<td><strong>MNAR</strong></td>
<td>People with very high <code>BMI</code> hide it</td>
<td>Sensitivity analysis, selection/pattern-mixture models</td>
<td>MAR-based MI alone is biased</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optional: Little’s MCAR Test
</div>
</div>
<div class="callout-body-container callout-body">
<p>Little’s MCAR test is a statistical procedure used to examine whether data are <strong>Missing Completely at Random (MCAR)</strong>.</p>
<p>⚠️ However, this test comes with important caveats:<br>
- It can be overly sensitive in <strong>large samples</strong>, flagging trivial deviations.<br>
- In <strong>small samples</strong>, its power is often too low to detect meaningful departures from MCAR.</p>
<p>Because of these limitations, it should be treated only as a <strong>supporting tool</strong> rather than a definitive test when diagnosing missingness mechanisms.</p>
</div>
</div>
</section>
</section>
<section id="detecting-missing-data" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="detecting-missing-data"><span class="header-section-number">5</span> Detecting Missing Data</h2>
<p>Before applying any imputation or modeling technique, it is essential to explore the <strong>extent and structure of missingness</strong> in the dataset. The <code>nhanes_sub</code> data frame, derived from the NHANES dataset, will be used for illustration.</p>
<section id="simple-counts-and-summaries" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="simple-counts-and-summaries"><span class="header-section-number">5.1</span> Simple Counts and Summaries</h3>
<p>The first step is to quantify how many values are missing per variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count missing values for each variable</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>nhanes_sub <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(.)))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
     ID   Age Gender   BMI BPSysAve Diabetes
  &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;    &lt;int&gt;    &lt;int&gt;
1     0     0      0   366     1449      142</code></pre>
</div>
</div>
<p>The output shows the number of missing values in each column, making it easy to spot problematic variables. Another quick check is to identify how many <strong>complete vs.&nbsp;incomplete cases</strong> exist:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">complete.cases</span>(nhanes_sub))       <span class="co"># number of complete rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8482</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">complete.cases</span>(nhanes_sub))      <span class="co"># number of incomplete rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1518</code></pre>
</div>
</div>
<p>This gives us an idea of the proportion of observations that would be lost if we opted for <strong>listwise deletion</strong>.</p>
</section>
<section id="visualizing-missingness" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="visualizing-missingness"><span class="header-section-number">5.2</span> Visualizing Missingness</h3>
<p>Textual summaries are informative, but missing data often has <strong>patterns</strong> that are better revealed visually. Several R packages support this task:</p>
<section id="naniar" class="level4" data-number="5.2.1">
<h4 data-number="5.2.1" class="anchored" data-anchor-id="naniar"><span class="header-section-number">5.2.1</span> <code>naniar</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missing values by variable</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(nhanes_sub, <span class="at">show_pct =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Missing Values by Variable in NHANES Subset"</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variables"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion of Missing Values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Each bar corresponds to a variable.</p></li>
<li><p>The <strong>height of the bar</strong> shows how many observations are missing for that variable.</p></li>
<li><p>With <code>show_pct = TRUE</code>, the proportion of missing values is also displayed, making it easier to compare across variables.</p></li>
<li><p>Variables with tall bars clearly have higher missingness (e.g., BMI or blood pressure variables often stand out in this dataset).</p></li>
</ul>
</section>
<section id="vim" class="level4" data-number="5.2.2">
<h4 data-number="5.2.2" class="anchored" data-anchor-id="vim"><span class="header-section-number">5.2.2</span> <code>VIM</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">aggr</span>(nhanes_sub, <span class="at">numbers =</span> <span class="cn">TRUE</span>, <span class="at">prop =</span> <span class="cn">FALSE</span>, <span class="at">sortVar =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Variables sorted by number of missings: 
 Variable Count
 BPSysAve  1449
      BMI   366
 Diabetes   142
       ID     0
      Age     0
   Gender     0</code></pre>
</div>
</div>
<p>This aggregated visualization shows the proportion of missing values per variable and the combinations of missingness across variables.</p>
</section>
<section id="visdat" class="level4" data-number="5.2.3">
<h4 data-number="5.2.3" class="anchored" data-anchor-id="visdat"><span class="header-section-number">5.2.3</span> <code>visdat</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visdat)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_dat</span>(nhanes_sub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This function displays the data type of each variable and overlays missingness, helping to identify whether missing values cluster in certain variable types (e.g., numeric vs.&nbsp;categorical).</p>
</section>
</section>
<section id="interpreting-the-patterns" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="interpreting-the-patterns"><span class="header-section-number">5.3</span> Interpreting the Patterns</h3>
<ul>
<li><strong>Random scatter of missing values</strong> across rows/columns may indicate <strong>MCAR</strong> (though formal testing is required).</li>
<li><strong>Systematic patterns</strong> (e.g., older participants more likely to have missing BMI) hint at <strong>MAR</strong>.</li>
<li><strong>Blocks of missingness</strong> (entire variables missing for subgroups) may suggest <strong>MNAR</strong> or structural missingness.</li>
</ul>
</section>
</section>
<section id="handling-missing-data-methods" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="handling-missing-data-methods"><span class="header-section-number">6</span> Handling Missing Data — Methods</h2>
<p>In this section we review the main families of methods, show <strong>when</strong> each is appropriate, and demonstrate them on <code>nhanes_sub</code>. We will explicitly call out the <strong>trade-offs</strong> so readers can choose deliberately—not by habit.</p>
<hr>
<section id="deletion" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="deletion"><span class="header-section-number">6.1</span> Deletion</h3>
<p><strong>Listwise deletion (complete-case)</strong> removes any row that contains <em>at least one</em> missing value.<br>
<strong>Pairwise deletion</strong> uses all available pairs to compute correlations/covariances, which can later lead to <strong>non–positive-definite</strong> covariance matrices and failures in modeling.</p>
<ul>
<li><p><strong>Pros</strong> - Simple; widely implemented by default (often silently). - Unbiased <em>only</em> under <strong>MCAR</strong>.</p></li>
<li><p><strong>Cons</strong> - Wastes data; reduces power. - Biased under <strong>MAR/MNAR</strong>; can change the sample composition.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many rows would we lose if we required complete cases for these variables?</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">nrow</span>(nhanes_sub)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>n_cc    <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">complete.cases</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_rows    =</span> n_total,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">complete_cases=</span> n_cc,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">lost_rows     =</span> n_total <span class="sc">-</span> n_cc,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">lost_pct      =</span> <span class="fu">round</span>((n_total <span class="sc">-</span> n_cc) <span class="sc">/</span> n_total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     total_rows complete_cases lost_rows lost_pct
[1,]      10000           8482      1518     15.2</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> If the lost percentage is non-trivial (e.g., &gt;5–10%), listwise deletion both <strong>shrinks power</strong> and <strong>risks bias</strong> unless MCAR truly holds. Pairwise deletion is <strong>not recommended</strong> for modeling because it can yield inconsistent covariance structures.</p>
</section>
<section id="simple-imputation" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="simple-imputation"><span class="header-section-number">6.2</span> Simple Imputation</h3>
<p><strong>Idea.</strong> Fill missing values with a single plausible value (one pass). Fast and convenient, but it <strong>underestimates uncertainty</strong> (standard errors too small) and can <strong>distort distributions</strong>.</p>
<p><strong>Typical choices</strong></p>
<ul>
<li><p><strong>Mean/Median/Mode</strong> (baselines; median is more robust to skew)</p></li>
<li><p><strong>k-Nearest Neighbors (kNN)</strong> (borrows information from similar rows)</p></li>
<li><p><strong>Hot-deck</strong> (donor-based; similar spirit to kNN)</p></li>
</ul>
<section id="median-numeric-mode-categorical-baselines" class="level4" data-number="6.2.1">
<h4 data-number="6.2.1" class="anchored" data-anchor-id="median-numeric-mode-categorical-baselines"><span class="header-section-number">6.2.1</span> Median (numeric) + Mode (categorical) baselines</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a median-imputed BMI for illustration (only if BMI is missing)</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>nh_med <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">BMI_med =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(BMI), stats<span class="sc">::</span><span class="fu">median</span>(BMI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), BMI)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare how many BMI were imputed</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(nhanes_sub<span class="sc">$</span>BMI))           <span class="co"># original missing BMI count</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 366</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(nh_med<span class="sc">$</span>BMI_med))           <span class="co"># should be 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p><strong>Distribution distortion (variance shrinkage).</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare BMI distribution: complete-case vs median-imputed</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>p_cc  <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(BMI)) <span class="sc">|&gt;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> BMI)) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"BMI density — complete cases"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>p_med <span class="ot">&lt;-</span> nh_med <span class="sc">|&gt;</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> BMI_med)) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"BMI density — median-imputed"</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>p_cc; p_med</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> Median imputation <strong>spikes</strong> the distribution around the median and <strong>reduces variance</strong>. This can attenuate real relationships that depend on dispersion.</p>
</section>
<section id="knn-donor-based-imputation" class="level4" data-number="6.2.2">
<h4 data-number="6.2.2" class="anchored" data-anchor-id="knn-donor-based-imputation"><span class="header-section-number">6.2.2</span> kNN (donor-based) imputation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># kNN imputation with VIM::kNN (works on data frames; chooses donors by similarity)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We impute only BMI here; set k=5 as a reasonable starting point.</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>nh_knn <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Age, Gender, BMI, BPSysAve, Diabetes) <span class="sc">|&gt;</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  VIM<span class="sc">::</span><span class="fu">kNN</span>(<span class="at">k =</span> <span class="dv">5</span>, <span class="at">imp_var =</span> <span class="cn">FALSE</span>)  <span class="co"># imp_var=FALSE avoids extra *_imp columns</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Check imputation effect</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(nhanes_sub<span class="sc">$</span>BMI))   <span class="co"># original missing BMI</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 366</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(nh_knn<span class="sc">$</span>BMI))       <span class="co"># after kNN (should be 0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> kNN preserves local structure better than mean/median, but it is still <strong>single imputation</strong> → uncertainty is <strong>not</strong> propagated. Choice of <strong>k</strong> and included predictors matters.</p>
<blockquote class="blockquote">
<p><strong>Rule of thumb.</strong> Simple methods are acceptable for quick EDA or as baselines. For principled inference under MAR, prefer <strong>Multiple Imputation</strong>.</p>
</blockquote>
</section>
</section>
<section id="advanced-methods" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="advanced-methods"><span class="header-section-number">6.3</span> Advanced Methods</h3>
<section id="multiple-imputation-with-mice" class="level4" data-number="6.3.1">
<h4 data-number="6.3.1" class="anchored" data-anchor-id="multiple-imputation-with-mice"><span class="header-section-number">6.3.1</span> Multiple Imputation with <code>mice</code></h4>
<p>So far, we have seen that missing values exist in several variables of our dataset. A common and powerful approach to handle missingness is <strong>Multiple Imputation by Chained Equations (MICE)</strong>. The <code>mice</code> package in R is widely used for this purpose. The idea is simple:</p>
<ul>
<li>Instead of filling in missing values once, MICE creates <strong>multiple complete datasets</strong> by imputing values several times.</li>
<li>Each dataset is then analyzed separately.</li>
<li>Finally, results are pooled together to account for the variability introduced by missingness.</li>
</ul>
<p>Let’s try this approach on our subset of the <code>NHANES</code> data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create imputations</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(nhanes_sub, <span class="at">m =</span> <span class="dv">3</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  BMI  BPSysAve  Diabetes
  1   2  BMI  BPSysAve  Diabetes
  1   3  BMI  BPSysAve  Diabetes
  2   1  BMI  BPSysAve  Diabetes
  2   2  BMI  BPSysAve  Diabetes
  2   3  BMI  BPSysAve  Diabetes
  3   1  BMI  BPSysAve  Diabetes
  3   2  BMI  BPSysAve  Diabetes
  3   3  BMI  BPSysAve  Diabetes
  4   1  BMI  BPSysAve  Diabetes
  4   2  BMI  BPSysAve  Diabetes
  4   3  BMI  BPSysAve  Diabetes
  5   1  BMI  BPSysAve  Diabetes
  5   2  BMI  BPSysAve  Diabetes
  5   3  BMI  BPSysAve  Diabetes</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at a summary</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>imp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Class: mids
Number of multiple imputations:  3 
Imputation methods:
      ID      Age   Gender      BMI BPSysAve Diabetes 
      ""       ""       ""    "pmm"    "pmm" "logreg" 
PredictorMatrix:
         ID Age Gender BMI BPSysAve Diabetes
ID        0   1      1   1        1        1
Age       1   0      1   1        1        1
Gender    1   1      0   1        1        1
BMI       1   1      1   0        1        1
BPSysAve  1   1      1   1        0        1
Diabetes  1   1      1   1        1        0</code></pre>
</div>
</div>
<p>The output shows:</p>
<ul>
<li><p><code>m = 3</code>: number of imputed datasets created.</p></li>
<li><p>For each variable with missingness, the method used for imputation.</p></li>
<li><p>How many iterations were performed in the algorithm.</p></li>
</ul>
<p>We can take a quick look at the imputed values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect first few imputations for BMI</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(imp<span class="sc">$</span>imp<span class="sc">$</span>BMI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1     2     3
61  43.00 17.70 12.90
161 16.70 13.50 18.59
210 16.28 24.00 23.10
309 24.00 37.32 26.20
310 24.00 28.55 26.30
320 25.10 32.25 29.20</code></pre>
</div>
</div>
<p>This shows different plausible values for missing BMI observations across the three imputed datasets. Each dataset gives slightly different results, which is expected and important for reflecting uncertainty.</p>
<p>Once we have these imputations, we can <strong>complete the dataset</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the first imputed dataset</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>nhanes_completed <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp, <span class="dv">1</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nhanes_completed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ID Age Gender   BMI BPSysAve Diabetes
1 51624  34   male 32.22      113       No
2 51624  34   male 32.22      113       No
3 51624  34   male 32.22      113       No
4 51625   4   male 15.30       92       No
5 51630  49 female 30.57      112       No
6 51638   9   male 16.82       86       No</code></pre>
</div>
</div>
<p>Now we have a complete dataset with no missing values. In practice, we would analyze all imputed datasets and then combine results using Rubin’s rules, but the key takeaway here is:</p>
<ul>
<li><p><code>mice()</code> provides multiple versions of the data,</p></li>
<li><p>imputations are based on relationships among variables,</p></li>
<li><p>and the method preserves uncertainty rather than hiding it.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
MICE Essentials: Key Arguments
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>method</strong>: Specifies the imputation model for each variable.</p>
<ul>
<li><code>pmm</code>: predictive mean matching (continuous variables)</li>
<li><code>logreg</code>: logistic regression (binary)</li>
<li><code>polyreg</code>: multinomial regression (nominal categorical)</li>
<li><code>polr</code>: proportional odds model (ordered categorical)</li>
</ul>
<p><em>Rule of thumb</em>: If a factor has &gt;2 levels, prefer <code>polyreg</code> (nominal) or <code>polr</code> (ordered) instead of <code>logreg</code>. Always check the actual levels of variables such as <code>Gender</code> or <code>Diabetes</code> in your data before setting methods.</p></li>
<li><p><strong>predictorMatrix</strong>: Controls which variables are used to predict others.</p>
<ul>
<li>Rows = target variables (to be imputed)</li>
<li>Columns = predictor variables</li>
</ul></li>
<li><p><strong>m</strong>: Number of multiple imputations to generate (commonly 5–20).</p>
<ul>
<li>More imputations recommended for high missingness.</li>
</ul></li>
<li><p><strong>maxit</strong>: Number of iterations of the chained equations (often 5–10).</p></li>
<li><p><strong>seed</strong>: Random seed for reproducibility.</p>
<ul>
<li>Always set when writing tutorials or reports.</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="multiple-imputation-with-missforest" class="level4" data-number="6.3.2">
<h4 data-number="6.3.2" class="anchored" data-anchor-id="multiple-imputation-with-missforest"><span class="header-section-number">6.3.2</span> Multiple Imputation with missForest</h4>
<p>The <strong>missForest</strong> package provides a non-parametric imputation method based on random forests.<br>
Unlike <code>mice</code>, which generates multiple imputations, <code>missForest</code> creates a <strong>single completed dataset</strong> by iteratively predicting missing values using random forest models. It works well with both continuous and categorical variables and can capture nonlinear relationships.</p>
<p>We will use the same <code>nhanes_sub</code> dataset as before:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missForest)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Start from the existing subset:</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># nhanes_sub &lt;- NHANES |&gt; select(ID, Age, Gender, BMI, BPSysAve, Diabetes)</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Keep only model-relevant columns (drop pure identifier)</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Convert character variables to factors (missForest expects factors, not raw character)</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Coerce to base data.frame to avoid tibble-related method dispatch issues</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>mf_input <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Age, Gender, BMI, BPSysAve, Diabetes) <span class="sc">|&gt;</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), as.factor)) <span class="sc">|&gt;</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>mf_fit <span class="ot">&lt;-</span> <span class="fu">missForest</span>(</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  mf_input,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">ntree   =</span> <span class="dv">200</span>,    <span class="co"># more trees -&gt; stabler imputations</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">5</span>,      <span class="co"># outer iterations (default 10; 5 is fine for demo)</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Completed data and OOB error</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>mf_imputed <span class="ot">&lt;-</span> mf_fit<span class="sc">$</span>ximp</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>mf_oob     <span class="ot">&lt;-</span> mf_fit<span class="sc">$</span>OOBerror</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick checks</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(mf_input<span class="sc">$</span>BMI))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 366</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(mf_imputed<span class="sc">$</span>BMI))   <span class="co"># should go to 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>mf_oob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     NRMSE        PFC 
0.17890307 0.02667884 </code></pre>
</div>
</div>
<p>The function returns a list with two key elements:</p>
<ul>
<li><p><code>ximp</code>: the completed dataset after imputation.</p></li>
<li><p><code>OOBerror</code>: the estimated imputation error (normalized root mean squared error for continuous variables and proportion of falsely classified entries for categorical variables).</p></li>
</ul>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>The <strong>completed dataset</strong> (<code>ximp</code>) replaces all missing values with imputed estimates.</p></li>
<li><p><strong>NRMSE (Normalized Root Mean Squared Error):</strong> <code>0.1789</code></p>
<ul>
<li>This value reflects the imputation error for continuous variables (e.g., <code>Age</code>, <code>BMI</code>, <code>BPSysAve</code>).</li>
<li>Since it is normalized, values closer to <strong>0</strong> indicate better accuracy. Here, an error of ~0.18 suggests that the imputed values are quite close to the true (non-missing) values.</li>
</ul></li>
<li><p><strong>PFC (Proportion of Falsely Classified):</strong> <code>0.0267</code></p>
<ul>
<li>This metric evaluates categorical variables (e.g., <code>Gender</code>, <code>Diabetes</code>).</li>
<li>A value of ~0.027 means only about <strong>2.7% of categorical imputations were misclassified</strong>, which is a strong performance.</li>
</ul></li>
</ul>
<p>✅ <strong>Interpretation:</strong><br>
The results indicate that <code>missForest</code> produced high-quality imputations: continuous variables are imputed with relatively low error, and categorical variables with very low misclassification. In practical terms, this means the dataset after imputation is reliable and close to the original data distribution.</p>
<p><strong>Pros and Cons of <code>missForest</code></strong></p>
<p><strong>Advantages:</strong></p>
<ul>
<li>Handles mixed data types (continuous + categorical).</li>
<li>Captures nonlinearities and complex interactions.</li>
<li>No need to specify an explicit imputation model.</li>
</ul>
<p><strong>Limitations:</strong></p>
<ul>
<li>Produces only a <strong>single imputed dataset</strong>, so uncertainty is not directly quantified (unlike <code>mice</code>).</li>
<li>Computationally more expensive for very large datasets.</li>
</ul>
</section>
</section>
</section>
<section id="single-vs.-multiple-imputation" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="single-vs.-multiple-imputation"><span class="header-section-number">7</span> Single vs.&nbsp;Multiple Imputation</h2>
<p>One critical distinction in handling missing data is <strong>single imputation</strong> vs.&nbsp;<strong>multiple imputation (MI)</strong>.</p>
<ul>
<li><p><strong>Single imputation</strong> (mean, median, regression, etc.) fills each missing value once. While simple, it <strong>ignores uncertainty</strong>, treating imputed values as if they were observed.</p></li>
<li><p><strong>Multiple imputation</strong> generates <strong>several plausible versions of the dataset</strong> (e.g., 5–10). Each dataset is analyzed separately, and results are then combined (pooled). This approach accounts for <strong>variability due to missingness</strong> and produces more reliable inferences.</p></li>
</ul>
<p>Let’s illustrate with our <code>nhanes_sub</code> dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete-case analysis (ignores missing data)</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>lm_cc <span class="ot">&lt;-</span> <span class="fu">lm</span>(BMI <span class="sc">~</span> Age <span class="sc">+</span> Gender <span class="sc">+</span> BPSysAve <span class="sc">+</span> Diabetes,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> nhanes_sub, <span class="at">na.action =</span> na.omit)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Single imputation (mean imputation for BMI)</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>nhanes_single <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span> </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BMI =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(BMI), <span class="fu">mean</span>(BMI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), BMI))</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>lm_si <span class="ot">&lt;-</span> <span class="fu">lm</span>(BMI <span class="sc">~</span> Age <span class="sc">+</span> Gender <span class="sc">+</span> BPSysAve <span class="sc">+</span> Diabetes,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> nhanes_single)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple imputation with mice</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(nhanes_sub, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">method =</span> <span class="st">"pmm"</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  BMI  BPSysAve  Diabetes
  1   2  BMI  BPSysAve  Diabetes
  1   3  BMI  BPSysAve  Diabetes
  1   4  BMI  BPSysAve  Diabetes
  1   5  BMI  BPSysAve  Diabetes
  2   1  BMI  BPSysAve  Diabetes
  2   2  BMI  BPSysAve  Diabetes
  2   3  BMI  BPSysAve  Diabetes
  2   4  BMI  BPSysAve  Diabetes
  2   5  BMI  BPSysAve  Diabetes
  3   1  BMI  BPSysAve  Diabetes
  3   2  BMI  BPSysAve  Diabetes
  3   3  BMI  BPSysAve  Diabetes
  3   4  BMI  BPSysAve  Diabetes
  3   5  BMI  BPSysAve  Diabetes
  4   1  BMI  BPSysAve  Diabetes
  4   2  BMI  BPSysAve  Diabetes
  4   3  BMI  BPSysAve  Diabetes
  4   4  BMI  BPSysAve  Diabetes
  4   5  BMI  BPSysAve  Diabetes
  5   1  BMI  BPSysAve  Diabetes
  5   2  BMI  BPSysAve  Diabetes
  5   3  BMI  BPSysAve  Diabetes
  5   4  BMI  BPSysAve  Diabetes
  5   5  BMI  BPSysAve  Diabetes</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>lm_mi <span class="ot">&lt;-</span> <span class="fu">with</span>(imp, <span class="fu">lm</span>(BMI <span class="sc">~</span> Age <span class="sc">+</span> Gender <span class="sc">+</span> BPSysAve <span class="sc">+</span> Diabetes))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>pooled <span class="ot">&lt;-</span> <span class="fu">pool</span>(lm_mi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_cc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BMI ~ Age + Gender + BPSysAve + Diabetes, data = nhanes_sub, 
    na.action = na.omit)

Residuals:
    Min      1Q  Median      3Q     Max 
-18.771  -4.640  -1.053   3.553  53.003 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.488597   0.513225  34.076   &lt;2e-16 ***
Age          0.047930   0.004273  11.217   &lt;2e-16 ***
Gendermale  -0.278756   0.144799  -1.925   0.0542 .  
BPSysAve     0.067504   0.004903  13.767   &lt;2e-16 ***
DiabetesYes  3.789606   0.265240  14.287   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.588 on 8477 degrees of freedom
  (1518 observations deleted due to missingness)
Multiple R-squared:  0.1136,    Adjusted R-squared:  0.1132 
F-statistic: 271.5 on 4 and 8477 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_si)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BMI ~ Age + Gender + BPSysAve + Diabetes, data = nhanes_single)

Residuals:
    Min      1Q  Median      3Q     Max 
-18.657  -4.634  -1.029   3.533  53.004 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.600406   0.508667  34.601   &lt;2e-16 ***
Age          0.047159   0.004237  11.129   &lt;2e-16 ***
Gendermale  -0.287221   0.143820  -1.997   0.0458 *  
BPSysAve     0.066791   0.004858  13.748   &lt;2e-16 ***
DiabetesYes  3.725941   0.262781  14.179   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.57 on 8541 degrees of freedom
  (1454 observations deleted due to missingness)
Multiple R-squared:  0.1118,    Adjusted R-squared:  0.1114 
F-statistic: 268.8 on 4 and 8541 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pooled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         term    estimate   std.error statistic       df       p.value
1 (Intercept) 14.66559186 0.487686304 30.071773 1253.210 5.075329e-150
2         Age  0.10367759 0.003748806 27.656164 3916.798 6.073157e-154
3  Gendermale -0.30521870 0.134707691 -2.265785 3727.382  2.352165e-02
4    BPSysAve  0.06754332 0.004761820 14.184349 1160.000  3.121286e-42
5 DiabetesYes  3.23549109 0.260299313 12.429887 8866.664  3.529334e-35</code></pre>
</div>
</div>
<p>We applied three different approaches to handle missing BMI values in the <code>nhanes_sub</code> dataset, modeling <strong>BMI ~ Age + Gender + BPSysAve + Diabetes</strong>. Here is what we found:</p>
<p><strong>1. Complete-Case Analysis (CCA)</strong></p>
<ul>
<li><p><strong>What we did:</strong> We dropped all observations with missing values (<code>na.omit</code>).</p></li>
<li><p><strong>Result:</strong></p>
<ul>
<li><p><strong>Coefficients:</strong> Age (0.048), BPSysAve (0.068), DiabetesYes (+3.79), Gender slightly negative.</p></li>
<li><p><strong>Standard errors:</strong> Relatively large because ~1500 observations were discarded.</p></li>
<li><p><strong>R²:</strong> 0.114 — fairly low.</p></li>
</ul></li>
<li><p><strong>Takeaway:</strong> CCA wastes data and may bias estimates if missingness is not MCAR (Missing Completely at Random).</p></li>
</ul>
<p><strong>2. Single Imputation (Mean Substitution for BMI)</strong></p>
<ul>
<li><p><strong>What we did:</strong> Replaced missing BMI values with the mean BMI.</p></li>
<li><p><strong>Result:</strong></p>
<ul>
<li><p><strong>Coefficients:</strong> Very close to CCA (Age 0.047, BPSysAve 0.067, DiabetesYes +3.73).</p></li>
<li><p><strong>Gender</strong> effect became just significant (<em>p</em> = 0.045).</p></li>
<li><p><strong>Residual SE</strong> decreased slightly (6.57).</p></li>
</ul></li>
<li><p><strong>Takeaway:</strong> Looks “better” because all observations are retained, but this approach <strong>ignores imputation uncertainty</strong> and artificially stabilizes estimates. Standard errors are underestimated, leading to overconfidence.</p></li>
</ul>
<p><strong>3. Multiple Imputation (MI with <code>mice</code>, m = 5, method = “pmm”)</strong></p>
<ul>
<li><p><strong>What we did:</strong> Generated 5 imputed datasets using Predictive Mean Matching (PMM), fit the same model in each, and pooled results.</p></li>
<li><p><strong>Result:</strong></p>
<ul>
<li><p><strong>Coefficients:</strong> Age effect doubled (0.104), intercept dropped (14.7 vs.&nbsp;~17.5), Diabetes effect slightly smaller (+3.24), Gender effect remained modest but significant (<em>p</em> = 0.023).</p></li>
<li><p><strong>Standard errors:</strong> Properly adjusted upwards — reflecting real uncertainty in imputed BMI values.</p></li>
<li><p><strong>Inference:</strong> Despite differences in point estimates, the conclusions are more <strong>statistically honest</strong>.</p></li>
</ul></li>
<li><p><strong>Takeaway:</strong> MI balances efficiency (uses all data) and validity (acknowledges missingness uncertainty).</p></li>
</ul>
<p><strong>🔑 Overall Comparison</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Keeps All Data</th>
<th>Coefficients Similar?</th>
<th>SE Adjusted for Uncertainty?</th>
<th>Main Issue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Complete Case (CCA)</td>
<td>❌ (~1500 rows lost)</td>
<td>Yes, but less precise</td>
<td>✅ (but biased if MAR/MNAR)</td>
<td>Data loss, possible bias</td>
</tr>
<tr class="even">
<td>Single Imputation (SI)</td>
<td>✅</td>
<td>Similar to CCA</td>
<td>❌ Underestimated</td>
<td>Overconfident inference</td>
</tr>
<tr class="odd">
<td>Multiple Imputation (MI)</td>
<td>✅</td>
<td>Somewhat different (esp.&nbsp;Age)</td>
<td>✅ Properly adjusted</td>
<td>More computation needed</td>
</tr>
</tbody>
</table>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p><strong>Complete-case</strong> drops too much data and risks bias.</p></li>
<li><p><strong>Single imputation</strong> keeps the data but gives <em>too much confidence</em> in results.</p></li>
<li><p><strong>Multiple imputation</strong> changes some coefficients (notably Age) and reports more realistic uncertaint</p></li>
</ul>
<p>👉 <strong>Lesson:</strong> If your goal is valid inference, especially in epidemiological or social science settings, <strong>multiple imputation is the gold standard</strong>.</p>
</section>
<section id="comparison-of-common-imputation-methods" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="comparison-of-common-imputation-methods"><span class="header-section-number">8</span> Comparison of Common Imputation Methods</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 29%">
<col style="width: 23%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Description</th>
<th>Advantages</th>
<th>Disadvantages</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Listwise Deletion</td>
<td>Removes all observations containing missing values</td>
<td>Very simple, quick to implement</td>
<td>Substantial data loss, potential bias</td>
</tr>
<tr class="even">
<td>Mean / Median / Mode</td>
<td>Replaces missing values with a fixed statistic</td>
<td>Easy to apply, preserves sample size</td>
<td>Reduces variance, distorts relationships</td>
</tr>
<tr class="odd">
<td>LOCF (Last Observation Carried Forward)</td>
<td>Uses the last available value (mainly time series)</td>
<td>Useful in longitudinal data, preserves continuity</td>
<td>Ignores trends, underestimates variability</td>
</tr>
<tr class="even">
<td>Linear Interpolation</td>
<td>Estimates missing values by connecting known data points</td>
<td>Maintains trends, intuitive</td>
<td>Fails with sudden changes or nonlinear patterns</td>
</tr>
<tr class="odd">
<td>KNN Imputation</td>
<td>Predicts missing values using nearest neighbors</td>
<td>Preserves multivariate structure, flexible</td>
<td>Computationally expensive, sensitive to k choice</td>
</tr>
<tr class="even">
<td>MICE (Multiple Imputation by Chained Equations)</td>
<td>Iterative regression-based multiple imputation</td>
<td>Accounts for uncertainty, widely used in research</td>
<td>Time-consuming, requires expertise</td>
</tr>
<tr class="odd">
<td>missForest</td>
<td>Uses Random Forest to impute missing values</td>
<td>Handles nonlinearities and interactions</td>
<td>Black-box method, computationally intensive</td>
</tr>
<tr class="even">
<td>EM Algorithm</td>
<td>Iterative expectation-maximization for likelihood-based estimation</td>
<td>Statistically principled, robust in theory</td>
<td>Requires strong assumptions, advanced knowledge</td>
</tr>
</tbody>
</table>
<p>No single imputation method is universally optimal—each comes with trade-offs between simplicity, accuracy, and interpretability. For instance, <strong>listwise deletion</strong> is tempting for its ease but can heavily bias results if missingness is not random. Simple <strong>mean or median imputation</strong> keeps the dataset intact but artificially reduces variability and masks true correlations. More advanced techniques such as <strong>MICE, missForest, and EM</strong> provide statistically sound imputations that preserve uncertainty and relationships, but they demand more computational resources and methodological expertise.</p>
<p>In practice:</p>
<ul>
<li><p><strong>Exploratory analysis</strong> often starts with simple methods (e.g., median replacement) to get a sense of the data.</p></li>
<li><p><strong>Time series data</strong> may rely on <strong>LOCF or interpolation</strong>.</p></li>
<li><p><strong>Complex survey or clinical datasets</strong> typically benefit from advanced approaches like <strong>MICE</strong> or <strong>missForest</strong>, which better respect the multivariate nature of the data.</p></li>
</ul>
<p>Ultimately, the choice depends on the <strong>data structure, missingness mechanism (MCAR, MAR, MNAR), and analytical goals</strong>.</p>
</section>
<section id="conclusion" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">9</span> Conclusion</h2>
<p>There is <strong>no one-size-fits-all</strong> solution for missing data. The right approach depends on your <strong>goal (prediction vs.&nbsp;inference)</strong>, the <strong>missingness mechanism (MCAR/MAR/MNAR)</strong>, your <strong>data structure</strong> (cross-sectional vs.&nbsp;longitudinal), and <strong>practical constraints</strong> (time, compute, expertise).</p>
<section id="what-our-nhanes-walkthrough-showed" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="what-our-nhanes-walkthrough-showed"><span class="header-section-number">9.1</span> What our NHANES walkthrough showed</h3>
<ul>
<li><strong>Complete-case analysis</strong> is simple but wastes data and can bias results unless MCAR is plausible.</li>
<li><strong>Single imputation</strong> (mean/median, kNN, missForest run once) keeps all rows but <strong>underestimates uncertainty</strong>, yielding overconfident inferences.</li>
<li><strong>Multiple imputation (MICE)</strong> typically strikes the best balance for <strong>inference under MAR</strong>: it preserves multivariate structure and <strong>propagates uncertainty</strong> (via pooling), producing more honest standard errors and CIs.</li>
<li><strong>Nonparametric imputers</strong> like <strong>missForest</strong> are strong for <strong>predictive accuracy</strong> on complex, nonlinear structure, but they do <strong>not</strong> capture imputation uncertainty by themselves.</li>
</ul>
</section>
<section id="practical-guidance-decision-oriented" class="level3" data-number="9.2">
<h3 data-number="9.2" class="anchored" data-anchor-id="practical-guidance-decision-oriented"><span class="header-section-number">9.2</span> Practical guidance (decision-oriented)</h3>
<ul>
<li><strong>If your main task is prediction</strong> and interpretability is secondary → a good single-imputation engine (e.g., <strong>missForest</strong>) can be effective, with careful validation.</li>
<li><strong>If your main task is inference</strong> (effect sizes, CIs, p-values) and <strong>MAR is reasonable</strong> → prefer <strong>MICE</strong>; include strong predictors of both the outcome and missingness; check diagnostics.</li>
<li><strong>If you suspect MNAR</strong> → acknowledge this explicitly and consider <strong>sensitivity analyses</strong> (pattern-mixture/selection models) rather than assuming MAR.</li>
</ul>
</section>
<section id="reporting-checklist-make-your-analysis-reproducible-credible" class="level3" data-number="9.3">
<h3 data-number="9.3" class="anchored" data-anchor-id="reporting-checklist-make-your-analysis-reproducible-credible"><span class="header-section-number">9.3</span> Reporting checklist (make your analysis reproducible &amp; credible)</h3>
<ul>
<li>% missing <strong>by variable</strong> and <strong>by key subgroups</strong> (e.g., Age, Gender).</li>
<li>Your <strong>assumed mechanism</strong> (MCAR/MAR/MNAR) and why it’s plausible.</li>
<li>The <strong>method(s)</strong> used (e.g., MICE with <code>pmm</code>, <code>m</code>, <code>maxit</code>, <code>predictorMatrix</code>; or missForest with <code>ntree</code>, <code>maxiter</code>).</li>
<li><strong>Diagnostics</strong> (trace/density/strip plots for MICE; OOB error for missForest).</li>
<li>For MI: <strong>pooled estimates</strong> with standard errors/intervals; clarify how pooling was performed.</li>
<li><strong>Limitations</strong> (e.g., potential MNAR, model misspecification, small-sample caveats).</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Rule of thumb.</strong> Use simple methods for quick EDA; use <strong>MICE</strong> for publication-grade inference under MAR; use <strong>missForest</strong> when you primarily need strong <strong>predictive performance</strong> on mixed/complex data.</p>
</div>
</div>
</section>
<section id="common-pitfalls-to-avoid" class="level3" data-number="9.4">
<h3 data-number="9.4" class="anchored" data-anchor-id="common-pitfalls-to-avoid"><span class="header-section-number">9.4</span> Common pitfalls to avoid</h3>
<ul>
<li>Treating imputed values as if they were observed “truth” (single imputation + significance testing).</li>
<li>Imputing the <strong>outcome</strong> itself (generally avoid; let it <em>inform</em> predictor imputations instead).</li>
<li>Ignoring <strong>leakage</strong>: fit imputers <strong>within</strong> resampling folds/splits, not on the full data.</li>
<li>Omitting key covariates that explain missingness (weakens the MAR assumption and the imputer).</li>
</ul>
</section>
<section id="where-to-go-next" class="level3" data-number="9.5">
<h3 data-number="9.5" class="anchored" data-anchor-id="where-to-go-next"><span class="header-section-number">9.5</span> Where to go next</h3>
<ul>
<li><strong>Leakage-free pipelines</strong> with <code>tidymodels::recipes</code> (train/test split done right).</li>
<li><strong>Sensitivity analyses</strong> for MNAR.</li>
<li><strong>Robustness checks</strong> (alternative imputation models, different <code>m</code>, predictor sets).</li>
</ul>
<p><strong>Bottom line:</strong> Choose methods intentionally, <strong>justify assumptions</strong>, show diagnostics, and <strong>report pooled results</strong> when using MI. Good missing-data practice is less about one magic function and more about transparent, principled workflow.</p>
</section>
</section>
<section id="references" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="references"><span class="header-section-number">10</span> References</h2>
<ul>
<li><p>Allison, P. D. (2001). <em>Missing Data</em>. Sage Publications.</p></li>
<li><p>Enders, C. K. (2010). <em>Applied Missing Data Analysis</em>. The Guilford Press.</p></li>
<li><p>Little, R. J. A., &amp; Rubin, D. B. (2002). <em>Statistical Analysis with Missing Data</em> (2nd ed.). Wiley.</p></li>
<li><p>van Buuren, S. (2018). <em>Flexible Imputation of Missing Data</em> (2nd ed.). Chapman &amp; Hall/CRC.</p></li>
<li><p>Stekhoven, D. J., &amp; Bühlmann, P. (2012). “MissForest—Nonparametric Missing Value Imputation for Mixed-Type Data.” <em>Bioinformatics</em>, 28(1), 112–118. https://doi.org/10.1093/bioinformatics/btr597</p></li>
<li><p>Rubin, D. B. (1987). <em>Multiple Imputation for Nonresponse in Surveys</em>. Wiley.</p></li>
<li><p>Schafer, J. L. (1997). <em>Analysis of Incomplete Multivariate Data</em>. Chapman &amp; Hall/CRC.</p></li>
<li><p>R Documentation: <a href="https://cran.r-project.org/package=mice"><code>mice</code> package</a></p></li>
<li><p>R Documentation: <a href="https://cran.r-project.org/package=missForest"><code>missForest</code> package</a></p></li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/mfatihtuzen\.netlify\.app");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="MFatihTuzen/blogComments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb58" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Handling Missing Data in R: A Comprehensive Guide"</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> M. Fatih Tüzen</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-08-18"</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [R, Statistics, Data Analysis, Data Science, Data Preprocessing, Missing Data, Data Cleaning, Imputation]</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 2</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-background: true</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="al">![](missing_values.png)</span>{fig-align="center" width="85%"}</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>Data preprocessing is a cornerstone of any data analysis or machine learning pipeline. Raw data rarely comes in a form ready for direct analysis — it often requires cleaning, transformation, normalization, and careful handling of anomalies. Among these preprocessing tasks, dealing with missing data stands out as one of the most critical and unavoidable challenges.</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>Missing values appear in virtually every domain: surveys may have skipped questions, administrative registers might contain incomplete records, and clinical trials can suffer from dropout patients. Ignoring these gaps or handling them naively does not just reduce the amount of usable information; it can also introduce bias, decrease statistical power, and ultimately compromise the validity of conclusions. In other words, missing data is not just an inconvenience — it is a methodological problem that demands rigorous attention.</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>In statistical practice, missingness is often represented as <span class="in">`NA`</span> (Not Available) in R. However, not all missing values are created equal. Some are missing completely at random, others depend on observed variables, and in some cases, the missingness itself carries meaningful information. Understanding these mechanisms is essential before deciding how to address them. This makes missing data imputation a fundamental part of the broader data preprocessing workflow, alongside tasks such as outlier detection, data normalization, and feature engineering.</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>In this article, we will cover:</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a><span class="ss">-    </span>The theoretical foundations of missing data mechanisms (MCAR, MAR, MNAR).</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>How to detect and visualize missing values in R.</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Different strategies for handling missingness, from simple imputation to advanced multiple imputation techniques.</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A practical workflow using the NHANES dataset, widely used in health research, to demonstrate methods in R.</span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Best practices, pitfalls, and recommendations for applied data science.</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>We will use several R packages throughout this tutorial:</span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a><span class="ss">-    </span>**tidyverse**: Data wrangling and visualization</span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**naniar** and **VIM**: Tools for exploring and visualizing missing data</span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**mice**: Multiple imputation by chained equations</span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**missForest**: Random forest–based imputation for nonlinear data</span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a>By integrating missing data handling into the larger context of preprocessing, this structured approach will not only help you manage incomplete datasets effectively but also ensure that your entire analytical workflow remains **robust, transparent, and reliable**.</span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a><span class="fu">## NHANES Dataset</span></span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a>In this section, we will work with the **NHANES** dataset, which comes from the US National Health and Nutrition Examination Survey.\</span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a>The dataset includes demographic, examination, and laboratory data collected from thousands of individuals.\</span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a>Since the full dataset is quite large, we will focus only on a subset of variables that are relevant for preprocessing examples.</span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true" tabindex="-1"></a>Here are the variables we will use:</span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-54"><a href="#cb58-54" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ID**: Unique identifier for each participant</span>
<span id="cb58-55"><a href="#cb58-55" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Age**: Age of the participant</span>
<span id="cb58-56"><a href="#cb58-56" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Gender**: Biological sex (male or female)</span>
<span id="cb58-57"><a href="#cb58-57" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**BMI**: Body Mass Index</span>
<span id="cb58-58"><a href="#cb58-58" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**BPSysAve**: Average systolic blood pressure</span>
<span id="cb58-59"><a href="#cb58-59" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Diabetes**: Whether the participant has been diagnosed with diabetes</span>
<span id="cb58-60"><a href="#cb58-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-61"><a href="#cb58-61" aria-hidden="true" tabindex="-1"></a>Before diving into preprocessing, let’s take a quick look at the structure of these selected variables:</span>
<span id="cb58-62"><a href="#cb58-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-65"><a href="#cb58-65" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-66"><a href="#cb58-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NHANES)</span>
<span id="cb58-67"><a href="#cb58-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb58-68"><a href="#cb58-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-69"><a href="#cb58-69" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"NHANES"</span>)</span>
<span id="cb58-70"><a href="#cb58-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-71"><a href="#cb58-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Select relevant variables</span></span>
<span id="cb58-72"><a href="#cb58-72" aria-hidden="true" tabindex="-1"></a>nhanes_sub <span class="ot">&lt;-</span> NHANES <span class="sc">|&gt;</span> </span>
<span id="cb58-73"><a href="#cb58-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Age, Gender, BMI, BPSysAve, Diabetes)</span>
<span id="cb58-74"><a href="#cb58-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-75"><a href="#cb58-75" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(nhanes_sub)</span>
<span id="cb58-76"><a href="#cb58-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-77"><a href="#cb58-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-78"><a href="#cb58-78" aria-hidden="true" tabindex="-1"></a><span class="fu">## Why Missingness Matters</span></span>
<span id="cb58-79"><a href="#cb58-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-80"><a href="#cb58-80" aria-hidden="true" tabindex="-1"></a>Missing data is not just an inconvenience — it can distort the statistical conclusions we draw from a dataset.\</span>
<span id="cb58-81"><a href="#cb58-81" aria-hidden="true" tabindex="-1"></a>There are several critical reasons why handling missingness properly is essential:</span>
<span id="cb58-82"><a href="#cb58-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-83"><a href="#cb58-83" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Biased results**: If the missing values are not random, analyses may systematically misrepresent the population.</span>
<span id="cb58-84"><a href="#cb58-84" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Reduced sample size**: Complete-case analysis (simply dropping missing rows) reduces data availability, weakening statistical power.</span>
<span id="cb58-85"><a href="#cb58-85" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Model incompatibility**: Many modeling techniques in R (e.g., <span class="in">`lm()`</span>, <span class="in">`glm()`</span>) require complete data, and will automatically drop cases with missing values, sometimes silently.</span>
<span id="cb58-86"><a href="#cb58-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-87"><a href="#cb58-87" aria-hidden="true" tabindex="-1"></a><span class="fu">### A Short Case Example: BMI Missingness and Blood Pressure</span></span>
<span id="cb58-88"><a href="#cb58-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-89"><a href="#cb58-89" aria-hidden="true" tabindex="-1"></a>Suppose we want to explore how **Body Mass Index (BMI)** relates to **Systolic Blood Pressure (BPSysAve)**.\</span>
<span id="cb58-90"><a href="#cb58-90" aria-hidden="true" tabindex="-1"></a>However, BMI contains missing values. If we ignore them and only analyze complete cases, we may end up with biased conclusions.</span>
<span id="cb58-91"><a href="#cb58-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-94"><a href="#cb58-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-95"><a href="#cb58-95" aria-hidden="true" tabindex="-1"></a><span class="co"># How many missing in BMI?</span></span>
<span id="cb58-96"><a href="#cb58-96" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(nhanes_sub<span class="sc">$</span>BMI))</span>
<span id="cb58-97"><a href="#cb58-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-98"><a href="#cb58-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete-case dataset (dropping missing BMI)</span></span>
<span id="cb58-99"><a href="#cb58-99" aria-hidden="true" tabindex="-1"></a>nhanes_complete <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span> </span>
<span id="cb58-100"><a href="#cb58-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(BMI))</span>
<span id="cb58-101"><a href="#cb58-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-102"><a href="#cb58-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare sample sizes</span></span>
<span id="cb58-103"><a href="#cb58-103" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(nhanes_sub)     <span class="co"># original sample size</span></span>
<span id="cb58-104"><a href="#cb58-104" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(nhanes_complete) <span class="co"># after dropping missing BMI</span></span>
<span id="cb58-105"><a href="#cb58-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-106"><a href="#cb58-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-107"><a href="#cb58-107" aria-hidden="true" tabindex="-1"></a>We see that a substantial portion of the data is dropped when we remove missing BMI values. This reduction not only decreases efficiency but can also **bias the estimates** if those missing values are not randomly distributed.</span>
<span id="cb58-108"><a href="#cb58-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-111"><a href="#cb58-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-112"><a href="#cb58-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression with complete cases only</span></span>
<span id="cb58-113"><a href="#cb58-113" aria-hidden="true" tabindex="-1"></a>model_complete <span class="ot">&lt;-</span> <span class="fu">lm</span>(BPSysAve <span class="sc">~</span> BMI <span class="sc">+</span> Age <span class="sc">+</span> Gender, <span class="at">data =</span> nhanes_complete)</span>
<span id="cb58-114"><a href="#cb58-114" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_complete)</span>
<span id="cb58-115"><a href="#cb58-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-116"><a href="#cb58-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-117"><a href="#cb58-117" aria-hidden="true" tabindex="-1"></a>**Interpretation**:</span>
<span id="cb58-118"><a href="#cb58-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-119"><a href="#cb58-119" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The model only uses complete cases, ignoring potentially informative missingness.</span>
<span id="cb58-120"><a href="#cb58-120" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If BMI is more often missing in certain subgroups (e.g., older adults or females), then the relationship estimated here does not represent the whole population.</span>
<span id="cb58-121"><a href="#cb58-121" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In later sections, we will see how different imputation strategies can mitigate this problem.</span>
<span id="cb58-122"><a href="#cb58-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-123"><a href="#cb58-123" aria-hidden="true" tabindex="-1"></a><span class="fu">## Missing Data Mechanisms</span></span>
<span id="cb58-124"><a href="#cb58-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-125"><a href="#cb58-125" aria-hidden="true" tabindex="-1"></a>One of the most crucial aspects of handling missing data is to understand **why** the data are missing.\</span>
<span id="cb58-126"><a href="#cb58-126" aria-hidden="true" tabindex="-1"></a>The mechanism behind missingness determines whether our chosen method will yield unbiased and efficient estimates.</span>
<span id="cb58-127"><a href="#cb58-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-128"><a href="#cb58-128" aria-hidden="true" tabindex="-1"></a><span class="fu">### Types of Missing Data Mechanisms</span></span>
<span id="cb58-129"><a href="#cb58-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-130"><a href="#cb58-130" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**MCAR (Missing Completely At Random)**\</span>
<span id="cb58-131"><a href="#cb58-131" aria-hidden="true" tabindex="-1"></a>    The probability of a value being missing does not depend on either the observed or the unobserved data.\</span>
<span id="cb58-132"><a href="#cb58-132" aria-hidden="true" tabindex="-1"></a>    → Example: A lab machine randomly fails for some patients, regardless of their characteristics.\</span>
<span id="cb58-133"><a href="#cb58-133" aria-hidden="true" tabindex="-1"></a>    → Implication: Complete-case analysis is valid (though less efficient).</span>
<span id="cb58-134"><a href="#cb58-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-135"><a href="#cb58-135" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**MAR (Missing At Random)**\</span>
<span id="cb58-136"><a href="#cb58-136" aria-hidden="true" tabindex="-1"></a>    The probability of missingness depends only on the **observed** data, not on the missing values themselves.\</span>
<span id="cb58-137"><a href="#cb58-137" aria-hidden="true" tabindex="-1"></a>    → Example: People with lower income are less likely to report their weight, but we observe income.\</span>
<span id="cb58-138"><a href="#cb58-138" aria-hidden="true" tabindex="-1"></a>    → Implication: Multiple imputation or likelihood-based methods can recover unbiased estimates.</span>
<span id="cb58-139"><a href="#cb58-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-140"><a href="#cb58-140" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**MNAR (Missing Not At Random)**\</span>
<span id="cb58-141"><a href="#cb58-141" aria-hidden="true" tabindex="-1"></a>    The probability of missingness depends on the **unobserved** value itself.\</span>
<span id="cb58-142"><a href="#cb58-142" aria-hidden="true" tabindex="-1"></a>    → Example: People with higher BMI are less likely to report their weight.\</span>
<span id="cb58-143"><a href="#cb58-143" aria-hidden="true" tabindex="-1"></a>    → Implication: Strong assumptions or external information are needed; imputation under MAR will still be biased.</span>
<span id="cb58-144"><a href="#cb58-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-145"><a href="#cb58-145" aria-hidden="true" tabindex="-1"></a><span class="fu">### What each mechanism implies (with NHANES intuition)</span></span>
<span id="cb58-146"><a href="#cb58-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-147"><a href="#cb58-147" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**MCAR** — e.g., random device failure that occasionally prevents recording <span class="in">`BMI`</span>.\</span>
<span id="cb58-148"><a href="#cb58-148" aria-hidden="true" tabindex="-1"></a>    *Implication:* Complete-case analysis (dropping rows) is unbiased but wastes data.</span>
<span id="cb58-149"><a href="#cb58-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-150"><a href="#cb58-150" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**MAR** — e.g., `BMI` missingness varies by observed **Age** or **Gender**.\</span>
<span id="cb58-151"><a href="#cb58-151" aria-hidden="true" tabindex="-1"></a>    *Implication:* Likelihood-based methods or **Multiple Imputation (MI)** are valid if those predictors are in the imputation model.</span>
<span id="cb58-152"><a href="#cb58-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-153"><a href="#cb58-153" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**MNAR** — e.g., people with **very high BMI** systematically do not report it.\</span>
<span id="cb58-154"><a href="#cb58-154" aria-hidden="true" tabindex="-1"></a>    *Implication:* MAR-based methods still biased; requires **sensitivity analysis** or explicit MNAR models.</span>
<span id="cb58-155"><a href="#cb58-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-156"><a href="#cb58-156" aria-hidden="true" tabindex="-1"></a><span class="fu">### Quick NHANES checks that suggest a mechanism</span></span>
<span id="cb58-157"><a href="#cb58-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-158"><a href="#cb58-158" aria-hidden="true" tabindex="-1"></a>Below we do two simple diagnostics on our working subset <span class="in">`nhanes_sub`</span>\</span>
<span id="cb58-159"><a href="#cb58-159" aria-hidden="true" tabindex="-1"></a>(defined earlier as: <span class="in">`NHANES |&gt; select(ID, Age, Gender, BMI, BPSysAve, Diabetes)`</span>).</span>
<span id="cb58-160"><a href="#cb58-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-163"><a href="#cb58-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-164"><a href="#cb58-164" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages we already use</span></span>
<span id="cb58-165"><a href="#cb58-165" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb58-166"><a href="#cb58-166" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb58-167"><a href="#cb58-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-168"><a href="#cb58-168" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Overall BMI missingness</span></span>
<span id="cb58-169"><a href="#cb58-169" aria-hidden="true" tabindex="-1"></a>nhanes_sub <span class="sc">|&gt;</span></span>
<span id="cb58-170"><a href="#cb58-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pct_missing_BMI =</span> <span class="fu">mean</span>(<span class="fu">is.na</span>(BMI)) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-171"><a href="#cb58-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_missing_BMI =</span> <span class="fu">round</span>(pct_missing_BMI, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb58-172"><a href="#cb58-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Overall BMI missingness (%)"</span>)</span>
<span id="cb58-173"><a href="#cb58-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-174"><a href="#cb58-174" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Does BMI missingness vary by observed variables? (MAR hint)</span></span>
<span id="cb58-175"><a href="#cb58-175" aria-hidden="true" tabindex="-1"></a><span class="co">#    - By Gender</span></span>
<span id="cb58-176"><a href="#cb58-176" aria-hidden="true" tabindex="-1"></a>by_gender <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span></span>
<span id="cb58-177"><a href="#cb58-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Gender) <span class="sc">|&gt;</span></span>
<span id="cb58-178"><a href="#cb58-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pct_miss_BMI =</span> <span class="fu">mean</span>(<span class="fu">is.na</span>(BMI)) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb58-179"><a href="#cb58-179" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-180"><a href="#cb58-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_miss_BMI =</span> <span class="fu">round</span>(pct_miss_BMI, <span class="dv">1</span>))</span>
<span id="cb58-181"><a href="#cb58-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-182"><a href="#cb58-182" aria-hidden="true" tabindex="-1"></a><span class="co">#    - By Age groups (bins)</span></span>
<span id="cb58-183"><a href="#cb58-183" aria-hidden="true" tabindex="-1"></a>by_age <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span></span>
<span id="cb58-184"><a href="#cb58-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AgeBand =</span> <span class="fu">cut</span>(Age, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">60</span>, <span class="cn">Inf</span>),</span>
<span id="cb58-185"><a href="#cb58-185" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;=30"</span>, <span class="st">"31–45"</span>, <span class="st">"46–60"</span>, <span class="st">"60+"</span>),</span>
<span id="cb58-186"><a href="#cb58-186" aria-hidden="true" tabindex="-1"></a>                       <span class="at">right =</span> <span class="cn">FALSE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb58-187"><a href="#cb58-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(AgeBand) <span class="sc">|&gt;</span></span>
<span id="cb58-188"><a href="#cb58-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pct_miss_BMI =</span> <span class="fu">mean</span>(<span class="fu">is.na</span>(BMI)) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb58-189"><a href="#cb58-189" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-190"><a href="#cb58-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_miss_BMI =</span> <span class="fu">round</span>(pct_miss_BMI, <span class="dv">1</span>))</span>
<span id="cb58-191"><a href="#cb58-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-192"><a href="#cb58-192" aria-hidden="true" tabindex="-1"></a><span class="co"># Show summaries nicely</span></span>
<span id="cb58-193"><a href="#cb58-193" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(by_gender, <span class="at">caption =</span> <span class="st">"BMI missingness by Gender (%)"</span>)</span>
<span id="cb58-194"><a href="#cb58-194" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(by_age,    <span class="at">caption =</span> <span class="st">"BMI missingness by Age band (%)"</span>)</span>
<span id="cb58-195"><a href="#cb58-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-196"><a href="#cb58-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-197"><a href="#cb58-197" aria-hidden="true" tabindex="-1"></a>**Interpretation:**</span>
<span id="cb58-198"><a href="#cb58-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-199"><a href="#cb58-199" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If <span class="in">`pct_miss_BMI`</span> is **similar across groups**, MCAR is more plausible.</span>
<span id="cb58-200"><a href="#cb58-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-201"><a href="#cb58-201" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If missingness **changes with Age or Gender**, **MAR** is more plausible (we must include those predictors in imputation).</span>
<span id="cb58-202"><a href="#cb58-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-203"><a href="#cb58-203" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>These are *indicators*, not proofs; true **MNAR** needs external info or sensitivity analyses.</span>
<span id="cb58-204"><a href="#cb58-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-205"><a href="#cb58-205" aria-hidden="true" tabindex="-1"></a>**Which methods are valid under which mechanism?**</span>
<span id="cb58-206"><a href="#cb58-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-207"><a href="#cb58-207" aria-hidden="true" tabindex="-1"></a>| Mechanism | Example (NHANES context)                             | Valid methods                                             | Notes                                    |</span>
<span id="cb58-208"><a href="#cb58-208" aria-hidden="true" tabindex="-1"></a>|-----------------|-------------------|---------------------|-----------------|</span>
<span id="cb58-209"><a href="#cb58-209" aria-hidden="true" tabindex="-1"></a>| **MCAR**  | Random loss of <span class="in">`BMI`</span> records                         | Complete-case, single imputation, MI                      | Unbiased but may waste data              |</span>
<span id="cb58-210"><a href="#cb58-210" aria-hidden="true" tabindex="-1"></a>| **MAR**   | `BMI` missingness varies by observed `Age`, `Gender` | **Multiple Imputation (MICE)**, likelihood/EM, missForest | Include strong predictors of missingness |</span>
<span id="cb58-211"><a href="#cb58-211" aria-hidden="true" tabindex="-1"></a>| **MNAR**  | People with very high <span class="in">`BMI`</span> hide it                  | Sensitivity analysis, selection/pattern-mixture models    | MAR-based MI alone is biased             |</span>
<span id="cb58-212"><a href="#cb58-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-213"><a href="#cb58-213" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb58-214"><a href="#cb58-214" aria-hidden="true" tabindex="-1"></a><span class="fu">### Optional: Little’s MCAR Test</span></span>
<span id="cb58-215"><a href="#cb58-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-216"><a href="#cb58-216" aria-hidden="true" tabindex="-1"></a>Little’s MCAR test is a statistical procedure used to examine whether data are **Missing Completely at Random (MCAR)**.</span>
<span id="cb58-217"><a href="#cb58-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-218"><a href="#cb58-218" aria-hidden="true" tabindex="-1"></a>⚠️ However, this test comes with important caveats:\</span>
<span id="cb58-219"><a href="#cb58-219" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>It can be overly sensitive in **large samples**, flagging trivial deviations.\</span>
<span id="cb58-220"><a href="#cb58-220" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In **small samples**, its power is often too low to detect meaningful departures from MCAR.</span>
<span id="cb58-221"><a href="#cb58-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-222"><a href="#cb58-222" aria-hidden="true" tabindex="-1"></a>Because of these limitations, it should be treated only as a **supporting tool** rather than a definitive test when diagnosing missingness mechanisms.</span>
<span id="cb58-223"><a href="#cb58-223" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb58-224"><a href="#cb58-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-225"><a href="#cb58-225" aria-hidden="true" tabindex="-1"></a><span class="fu">## Detecting Missing Data</span></span>
<span id="cb58-226"><a href="#cb58-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-227"><a href="#cb58-227" aria-hidden="true" tabindex="-1"></a>Before applying any imputation or modeling technique, it is essential to explore the **extent and structure of missingness** in the dataset. The <span class="in">`nhanes_sub`</span> data frame, derived from the NHANES dataset, will be used for illustration.</span>
<span id="cb58-228"><a href="#cb58-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-229"><a href="#cb58-229" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simple Counts and Summaries</span></span>
<span id="cb58-230"><a href="#cb58-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-231"><a href="#cb58-231" aria-hidden="true" tabindex="-1"></a>The first step is to quantify how many values are missing per variable.</span>
<span id="cb58-232"><a href="#cb58-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-235"><a href="#cb58-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-236"><a href="#cb58-236" aria-hidden="true" tabindex="-1"></a><span class="co"># Count missing values for each variable</span></span>
<span id="cb58-237"><a href="#cb58-237" aria-hidden="true" tabindex="-1"></a>nhanes_sub <span class="sc">%&gt;%</span></span>
<span id="cb58-238"><a href="#cb58-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(.)))) </span>
<span id="cb58-239"><a href="#cb58-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-240"><a href="#cb58-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-241"><a href="#cb58-241" aria-hidden="true" tabindex="-1"></a>The output shows the number of missing values in each column, making it easy to spot problematic variables. Another quick check is to identify how many **complete vs. incomplete cases** exist:</span>
<span id="cb58-242"><a href="#cb58-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-245"><a href="#cb58-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-246"><a href="#cb58-246" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">complete.cases</span>(nhanes_sub))       <span class="co"># number of complete rows</span></span>
<span id="cb58-247"><a href="#cb58-247" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">complete.cases</span>(nhanes_sub))      <span class="co"># number of incomplete rows</span></span>
<span id="cb58-248"><a href="#cb58-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-249"><a href="#cb58-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-250"><a href="#cb58-250" aria-hidden="true" tabindex="-1"></a>This gives us an idea of the proportion of observations that would be lost if we opted for **listwise deletion**.</span>
<span id="cb58-251"><a href="#cb58-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-252"><a href="#cb58-252" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualizing Missingness</span></span>
<span id="cb58-253"><a href="#cb58-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-254"><a href="#cb58-254" aria-hidden="true" tabindex="-1"></a>Textual summaries are informative, but missing data often has **patterns** that are better revealed visually. Several R packages support this task:</span>
<span id="cb58-255"><a href="#cb58-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-256"><a href="#cb58-256" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `naniar`</span></span>
<span id="cb58-257"><a href="#cb58-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-260"><a href="#cb58-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-261"><a href="#cb58-261" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb58-262"><a href="#cb58-262" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb58-263"><a href="#cb58-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-264"><a href="#cb58-264" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missing values by variable</span></span>
<span id="cb58-265"><a href="#cb58-265" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(nhanes_sub, <span class="at">show_pct =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb58-266"><a href="#cb58-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Missing Values by Variable in NHANES Subset"</span>,</span>
<span id="cb58-267"><a href="#cb58-267" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variables"</span>,</span>
<span id="cb58-268"><a href="#cb58-268" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion of Missing Values"</span>)</span>
<span id="cb58-269"><a href="#cb58-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-270"><a href="#cb58-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-271"><a href="#cb58-271" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Each bar corresponds to a variable.</span>
<span id="cb58-272"><a href="#cb58-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-273"><a href="#cb58-273" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The **height of the bar** shows how many observations are missing for that variable.</span>
<span id="cb58-274"><a href="#cb58-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-275"><a href="#cb58-275" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>With <span class="in">`show_pct = TRUE`</span>, the proportion of missing values is also displayed, making it easier to compare across variables.</span>
<span id="cb58-276"><a href="#cb58-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-277"><a href="#cb58-277" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Variables with tall bars clearly have higher missingness (e.g., BMI or blood pressure variables often stand out in this dataset).</span>
<span id="cb58-278"><a href="#cb58-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-279"><a href="#cb58-279" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `VIM`</span></span>
<span id="cb58-280"><a href="#cb58-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-283"><a href="#cb58-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-284"><a href="#cb58-284" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb58-285"><a href="#cb58-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-286"><a href="#cb58-286" aria-hidden="true" tabindex="-1"></a><span class="fu">aggr</span>(nhanes_sub, <span class="at">numbers =</span> <span class="cn">TRUE</span>, <span class="at">prop =</span> <span class="cn">FALSE</span>, <span class="at">sortVar =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-287"><a href="#cb58-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-288"><a href="#cb58-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-289"><a href="#cb58-289" aria-hidden="true" tabindex="-1"></a>This aggregated visualization shows the proportion of missing values per variable and the combinations of missingness across variables.</span>
<span id="cb58-290"><a href="#cb58-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-291"><a href="#cb58-291" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `visdat`</span></span>
<span id="cb58-292"><a href="#cb58-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-295"><a href="#cb58-295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-296"><a href="#cb58-296" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visdat)</span>
<span id="cb58-297"><a href="#cb58-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-298"><a href="#cb58-298" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_dat</span>(nhanes_sub)</span>
<span id="cb58-299"><a href="#cb58-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-300"><a href="#cb58-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-301"><a href="#cb58-301" aria-hidden="true" tabindex="-1"></a>This function displays the data type of each variable and overlays missingness, helping to identify whether missing values cluster in certain variable types (e.g., numeric vs. categorical).</span>
<span id="cb58-302"><a href="#cb58-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-303"><a href="#cb58-303" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpreting the Patterns</span></span>
<span id="cb58-304"><a href="#cb58-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-305"><a href="#cb58-305" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Random scatter of missing values** across rows/columns may indicate **MCAR** (though formal testing is required).</span>
<span id="cb58-306"><a href="#cb58-306" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Systematic patterns** (e.g., older participants more likely to have missing BMI) hint at **MAR**.</span>
<span id="cb58-307"><a href="#cb58-307" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Blocks of missingness** (entire variables missing for subgroups) may suggest **MNAR** or structural missingness.</span>
<span id="cb58-308"><a href="#cb58-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-309"><a href="#cb58-309" aria-hidden="true" tabindex="-1"></a><span class="fu">## Handling Missing Data — Methods</span></span>
<span id="cb58-310"><a href="#cb58-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-311"><a href="#cb58-311" aria-hidden="true" tabindex="-1"></a>In this section we review the main families of methods, show **when** each is appropriate, and demonstrate them on `nhanes_sub`. We will explicitly call out the **trade-offs** so readers can choose deliberately—not by habit.</span>
<span id="cb58-312"><a href="#cb58-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-313"><a href="#cb58-313" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb58-314"><a href="#cb58-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-315"><a href="#cb58-315" aria-hidden="true" tabindex="-1"></a><span class="fu">### Deletion</span></span>
<span id="cb58-316"><a href="#cb58-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-317"><a href="#cb58-317" aria-hidden="true" tabindex="-1"></a>**Listwise deletion (complete-case)** removes any row that contains *at least one* missing value.\</span>
<span id="cb58-318"><a href="#cb58-318" aria-hidden="true" tabindex="-1"></a>**Pairwise deletion** uses all available pairs to compute correlations/covariances, which can later lead to **non–positive-definite** covariance matrices and failures in modeling.</span>
<span id="cb58-319"><a href="#cb58-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-320"><a href="#cb58-320" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Pros** - Simple; widely implemented by default (often silently). - Unbiased *only* under **MCAR**.</span>
<span id="cb58-321"><a href="#cb58-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-322"><a href="#cb58-322" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Cons** - Wastes data; reduces power. - Biased under **MAR/MNAR**; can change the sample composition.</span>
<span id="cb58-323"><a href="#cb58-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-326"><a href="#cb58-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-327"><a href="#cb58-327" aria-hidden="true" tabindex="-1"></a><span class="co"># How many rows would we lose if we required complete cases for these variables?</span></span>
<span id="cb58-328"><a href="#cb58-328" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">nrow</span>(nhanes_sub)</span>
<span id="cb58-329"><a href="#cb58-329" aria-hidden="true" tabindex="-1"></a>n_cc    <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">complete.cases</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb58-330"><a href="#cb58-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-331"><a href="#cb58-331" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(</span>
<span id="cb58-332"><a href="#cb58-332" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_rows    =</span> n_total,</span>
<span id="cb58-333"><a href="#cb58-333" aria-hidden="true" tabindex="-1"></a>  <span class="at">complete_cases=</span> n_cc,</span>
<span id="cb58-334"><a href="#cb58-334" aria-hidden="true" tabindex="-1"></a>  <span class="at">lost_rows     =</span> n_total <span class="sc">-</span> n_cc,</span>
<span id="cb58-335"><a href="#cb58-335" aria-hidden="true" tabindex="-1"></a>  <span class="at">lost_pct      =</span> <span class="fu">round</span>((n_total <span class="sc">-</span> n_cc) <span class="sc">/</span> n_total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb58-336"><a href="#cb58-336" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-337"><a href="#cb58-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-338"><a href="#cb58-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-339"><a href="#cb58-339" aria-hidden="true" tabindex="-1"></a>**Interpretation:** If the lost percentage is non-trivial (e.g., \&gt;5–10%), listwise deletion both **shrinks power** and **risks bias** unless MCAR truly holds. Pairwise deletion is **not recommended** for modeling because it can yield inconsistent covariance structures.</span>
<span id="cb58-340"><a href="#cb58-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-341"><a href="#cb58-341" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simple Imputation</span></span>
<span id="cb58-342"><a href="#cb58-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-343"><a href="#cb58-343" aria-hidden="true" tabindex="-1"></a>**Idea.** Fill missing values with a single plausible value (one pass). Fast and convenient, but it **underestimates uncertainty** (standard errors too small) and can **distort distributions**.</span>
<span id="cb58-344"><a href="#cb58-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-345"><a href="#cb58-345" aria-hidden="true" tabindex="-1"></a>**Typical choices**</span>
<span id="cb58-346"><a href="#cb58-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-347"><a href="#cb58-347" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Mean/Median/Mode** (baselines; median is more robust to skew)</span>
<span id="cb58-348"><a href="#cb58-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-349"><a href="#cb58-349" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**k-Nearest Neighbors (kNN)** (borrows information from similar rows)</span>
<span id="cb58-350"><a href="#cb58-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-351"><a href="#cb58-351" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Hot-deck** (donor-based; similar spirit to kNN)</span>
<span id="cb58-352"><a href="#cb58-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-353"><a href="#cb58-353" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Median (numeric) + Mode (categorical) baselines</span></span>
<span id="cb58-354"><a href="#cb58-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-357"><a href="#cb58-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-358"><a href="#cb58-358" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb58-359"><a href="#cb58-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-360"><a href="#cb58-360" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a median-imputed BMI for illustration (only if BMI is missing)</span></span>
<span id="cb58-361"><a href="#cb58-361" aria-hidden="true" tabindex="-1"></a>nh_med <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span></span>
<span id="cb58-362"><a href="#cb58-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb58-363"><a href="#cb58-363" aria-hidden="true" tabindex="-1"></a>    <span class="at">BMI_med =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(BMI), stats<span class="sc">::</span><span class="fu">median</span>(BMI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), BMI)</span>
<span id="cb58-364"><a href="#cb58-364" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-365"><a href="#cb58-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-366"><a href="#cb58-366" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare how many BMI were imputed</span></span>
<span id="cb58-367"><a href="#cb58-367" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(nhanes_sub<span class="sc">$</span>BMI))           <span class="co"># original missing BMI count</span></span>
<span id="cb58-368"><a href="#cb58-368" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(nh_med<span class="sc">$</span>BMI_med))           <span class="co"># should be 0</span></span>
<span id="cb58-369"><a href="#cb58-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-370"><a href="#cb58-370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-371"><a href="#cb58-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-372"><a href="#cb58-372" aria-hidden="true" tabindex="-1"></a>**Distribution distortion (variance shrinkage).**</span>
<span id="cb58-373"><a href="#cb58-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-376"><a href="#cb58-376" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-377"><a href="#cb58-377" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb58-378"><a href="#cb58-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-379"><a href="#cb58-379" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare BMI distribution: complete-case vs median-imputed</span></span>
<span id="cb58-380"><a href="#cb58-380" aria-hidden="true" tabindex="-1"></a>p_cc  <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span></span>
<span id="cb58-381"><a href="#cb58-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(BMI)) <span class="sc">|&gt;</span></span>
<span id="cb58-382"><a href="#cb58-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> BMI)) <span class="sc">+</span></span>
<span id="cb58-383"><a href="#cb58-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb58-384"><a href="#cb58-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"BMI density — complete cases"</span>)</span>
<span id="cb58-385"><a href="#cb58-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-386"><a href="#cb58-386" aria-hidden="true" tabindex="-1"></a>p_med <span class="ot">&lt;-</span> nh_med <span class="sc">|&gt;</span></span>
<span id="cb58-387"><a href="#cb58-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> BMI_med)) <span class="sc">+</span></span>
<span id="cb58-388"><a href="#cb58-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb58-389"><a href="#cb58-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"BMI density — median-imputed"</span>)</span>
<span id="cb58-390"><a href="#cb58-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-391"><a href="#cb58-391" aria-hidden="true" tabindex="-1"></a>p_cc; p_med</span>
<span id="cb58-392"><a href="#cb58-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-393"><a href="#cb58-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-394"><a href="#cb58-394" aria-hidden="true" tabindex="-1"></a>**Interpretation:** Median imputation **spikes** the distribution around the median and **reduces variance**. This can attenuate real relationships that depend on dispersion.</span>
<span id="cb58-395"><a href="#cb58-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-396"><a href="#cb58-396" aria-hidden="true" tabindex="-1"></a><span class="fu">#### kNN (donor-based) imputation</span></span>
<span id="cb58-397"><a href="#cb58-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-400"><a href="#cb58-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-401"><a href="#cb58-401" aria-hidden="true" tabindex="-1"></a><span class="co"># kNN imputation with VIM::kNN (works on data frames; chooses donors by similarity)</span></span>
<span id="cb58-402"><a href="#cb58-402" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb58-403"><a href="#cb58-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-404"><a href="#cb58-404" aria-hidden="true" tabindex="-1"></a><span class="co"># We impute only BMI here; set k=5 as a reasonable starting point.</span></span>
<span id="cb58-405"><a href="#cb58-405" aria-hidden="true" tabindex="-1"></a>nh_knn <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span></span>
<span id="cb58-406"><a href="#cb58-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Age, Gender, BMI, BPSysAve, Diabetes) <span class="sc">|&gt;</span></span>
<span id="cb58-407"><a href="#cb58-407" aria-hidden="true" tabindex="-1"></a>  VIM<span class="sc">::</span><span class="fu">kNN</span>(<span class="at">k =</span> <span class="dv">5</span>, <span class="at">imp_var =</span> <span class="cn">FALSE</span>)  <span class="co"># imp_var=FALSE avoids extra *_imp columns</span></span>
<span id="cb58-408"><a href="#cb58-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-409"><a href="#cb58-409" aria-hidden="true" tabindex="-1"></a><span class="co"># Check imputation effect</span></span>
<span id="cb58-410"><a href="#cb58-410" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(nhanes_sub<span class="sc">$</span>BMI))   <span class="co"># original missing BMI</span></span>
<span id="cb58-411"><a href="#cb58-411" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(nh_knn<span class="sc">$</span>BMI))       <span class="co"># after kNN (should be 0)</span></span>
<span id="cb58-412"><a href="#cb58-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-413"><a href="#cb58-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-414"><a href="#cb58-414" aria-hidden="true" tabindex="-1"></a>**Interpretation:** kNN preserves local structure better than mean/median, but it is still **single imputation** → uncertainty is **not** propagated. Choice of **k** and included predictors matters.</span>
<span id="cb58-415"><a href="#cb58-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-416"><a href="#cb58-416" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **Rule of thumb.** Simple methods are acceptable for quick EDA or as baselines. For principled inference under MAR, prefer **Multiple Imputation**.</span></span>
<span id="cb58-417"><a href="#cb58-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-418"><a href="#cb58-418" aria-hidden="true" tabindex="-1"></a><span class="fu">### Advanced Methods</span></span>
<span id="cb58-419"><a href="#cb58-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-420"><a href="#cb58-420" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Multiple Imputation with `mice`</span></span>
<span id="cb58-421"><a href="#cb58-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-422"><a href="#cb58-422" aria-hidden="true" tabindex="-1"></a>So far, we have seen that missing values exist in several variables of our dataset. A common and powerful approach to handle missingness is **Multiple Imputation by Chained Equations (MICE)**. The <span class="in">`mice`</span> package in R is widely used for this purpose. The idea is simple:</span>
<span id="cb58-423"><a href="#cb58-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-424"><a href="#cb58-424" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Instead of filling in missing values once, MICE creates **multiple complete datasets** by imputing values several times.</span>
<span id="cb58-425"><a href="#cb58-425" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Each dataset is then analyzed separately.</span>
<span id="cb58-426"><a href="#cb58-426" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Finally, results are pooled together to account for the variability introduced by missingness.</span>
<span id="cb58-427"><a href="#cb58-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-428"><a href="#cb58-428" aria-hidden="true" tabindex="-1"></a>Let’s try this approach on our subset of the <span class="in">`NHANES`</span> data:</span>
<span id="cb58-429"><a href="#cb58-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-432"><a href="#cb58-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-433"><a href="#cb58-433" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb58-434"><a href="#cb58-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-435"><a href="#cb58-435" aria-hidden="true" tabindex="-1"></a><span class="co"># Create imputations</span></span>
<span id="cb58-436"><a href="#cb58-436" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(nhanes_sub, <span class="at">m =</span> <span class="dv">3</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb58-437"><a href="#cb58-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-438"><a href="#cb58-438" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at a summary</span></span>
<span id="cb58-439"><a href="#cb58-439" aria-hidden="true" tabindex="-1"></a>imp</span>
<span id="cb58-440"><a href="#cb58-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-441"><a href="#cb58-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-442"><a href="#cb58-442" aria-hidden="true" tabindex="-1"></a>The output shows:</span>
<span id="cb58-443"><a href="#cb58-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-444"><a href="#cb58-444" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`m = 3`</span>: number of imputed datasets created.</span>
<span id="cb58-445"><a href="#cb58-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-446"><a href="#cb58-446" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For each variable with missingness, the method used for imputation.</span>
<span id="cb58-447"><a href="#cb58-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-448"><a href="#cb58-448" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>How many iterations were performed in the algorithm.</span>
<span id="cb58-449"><a href="#cb58-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-450"><a href="#cb58-450" aria-hidden="true" tabindex="-1"></a>We can take a quick look at the imputed values:</span>
<span id="cb58-451"><a href="#cb58-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-454"><a href="#cb58-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-455"><a href="#cb58-455" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect first few imputations for BMI</span></span>
<span id="cb58-456"><a href="#cb58-456" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(imp<span class="sc">$</span>imp<span class="sc">$</span>BMI)</span>
<span id="cb58-457"><a href="#cb58-457" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-458"><a href="#cb58-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-459"><a href="#cb58-459" aria-hidden="true" tabindex="-1"></a>This shows different plausible values for missing BMI observations across the three imputed datasets. Each dataset gives slightly different results, which is expected and important for reflecting uncertainty.</span>
<span id="cb58-460"><a href="#cb58-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-461"><a href="#cb58-461" aria-hidden="true" tabindex="-1"></a>Once we have these imputations, we can **complete the dataset**:</span>
<span id="cb58-462"><a href="#cb58-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-465"><a href="#cb58-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-466"><a href="#cb58-466" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the first imputed dataset</span></span>
<span id="cb58-467"><a href="#cb58-467" aria-hidden="true" tabindex="-1"></a>nhanes_completed <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp, <span class="dv">1</span>)</span>
<span id="cb58-468"><a href="#cb58-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-469"><a href="#cb58-469" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nhanes_completed)</span>
<span id="cb58-470"><a href="#cb58-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-471"><a href="#cb58-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-472"><a href="#cb58-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-473"><a href="#cb58-473" aria-hidden="true" tabindex="-1"></a>Now we have a complete dataset with no missing values. In practice, we would analyze all imputed datasets and then combine results using Rubin’s rules, but the key takeaway here is:</span>
<span id="cb58-474"><a href="#cb58-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-475"><a href="#cb58-475" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`mice()`</span> provides multiple versions of the data,</span>
<span id="cb58-476"><a href="#cb58-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-477"><a href="#cb58-477" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>imputations are based on relationships among variables,</span>
<span id="cb58-478"><a href="#cb58-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-479"><a href="#cb58-479" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>and the method preserves uncertainty rather than hiding it.</span>
<span id="cb58-480"><a href="#cb58-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-481"><a href="#cb58-481" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb58-482"><a href="#cb58-482" aria-hidden="true" tabindex="-1"></a><span class="fu">### MICE Essentials: Key Arguments</span></span>
<span id="cb58-483"><a href="#cb58-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-484"><a href="#cb58-484" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**method**: Specifies the imputation model for each variable.</span>
<span id="cb58-485"><a href="#cb58-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-486"><a href="#cb58-486" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`pmm`</span>: predictive mean matching (continuous variables)</span>
<span id="cb58-487"><a href="#cb58-487" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`logreg`</span>: logistic regression (binary)</span>
<span id="cb58-488"><a href="#cb58-488" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`polyreg`</span>: multinomial regression (nominal categorical)</span>
<span id="cb58-489"><a href="#cb58-489" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`polr`</span>: proportional odds model (ordered categorical)</span>
<span id="cb58-490"><a href="#cb58-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-491"><a href="#cb58-491" aria-hidden="true" tabindex="-1"></a>    *Rule of thumb*: If a factor has <span class="sc">\&gt;</span>2 levels, prefer <span class="in">`polyreg`</span> (nominal) or <span class="in">`polr`</span> (ordered) instead of <span class="in">`logreg`</span>. Always check the actual levels of variables such as <span class="in">`Gender`</span> or <span class="in">`Diabetes`</span> in your data before setting methods.</span>
<span id="cb58-492"><a href="#cb58-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-493"><a href="#cb58-493" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**predictorMatrix**: Controls which variables are used to predict others.</span>
<span id="cb58-494"><a href="#cb58-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-495"><a href="#cb58-495" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Rows = target variables (to be imputed)</span>
<span id="cb58-496"><a href="#cb58-496" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Columns = predictor variables</span>
<span id="cb58-497"><a href="#cb58-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-498"><a href="#cb58-498" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**m**: Number of multiple imputations to generate (commonly 5–20).</span>
<span id="cb58-499"><a href="#cb58-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-500"><a href="#cb58-500" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>More imputations recommended for high missingness.</span>
<span id="cb58-501"><a href="#cb58-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-502"><a href="#cb58-502" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**maxit**: Number of iterations of the chained equations (often 5–10).</span>
<span id="cb58-503"><a href="#cb58-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-504"><a href="#cb58-504" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**seed**: Random seed for reproducibility.</span>
<span id="cb58-505"><a href="#cb58-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-506"><a href="#cb58-506" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Always set when writing tutorials or reports.</span>
<span id="cb58-507"><a href="#cb58-507" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb58-508"><a href="#cb58-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-509"><a href="#cb58-509" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Multiple Imputation with missForest</span></span>
<span id="cb58-510"><a href="#cb58-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-511"><a href="#cb58-511" aria-hidden="true" tabindex="-1"></a>The **missForest** package provides a non-parametric imputation method based on random forests.\</span>
<span id="cb58-512"><a href="#cb58-512" aria-hidden="true" tabindex="-1"></a>Unlike <span class="in">`mice`</span>, which generates multiple imputations, <span class="in">`missForest`</span> creates a **single completed dataset** by iteratively predicting missing values using random forest models. It works well with both continuous and categorical variables and can capture nonlinear relationships.</span>
<span id="cb58-513"><a href="#cb58-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-514"><a href="#cb58-514" aria-hidden="true" tabindex="-1"></a>We will use the same <span class="in">`nhanes_sub`</span> dataset as before:</span>
<span id="cb58-515"><a href="#cb58-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-518"><a href="#cb58-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-519"><a href="#cb58-519" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb58-520"><a href="#cb58-520" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missForest)</span>
<span id="cb58-521"><a href="#cb58-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-522"><a href="#cb58-522" aria-hidden="true" tabindex="-1"></a><span class="co"># Start from the existing subset:</span></span>
<span id="cb58-523"><a href="#cb58-523" aria-hidden="true" tabindex="-1"></a><span class="co"># nhanes_sub &lt;- NHANES |&gt; select(ID, Age, Gender, BMI, BPSysAve, Diabetes)</span></span>
<span id="cb58-524"><a href="#cb58-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-525"><a href="#cb58-525" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Keep only model-relevant columns (drop pure identifier)</span></span>
<span id="cb58-526"><a href="#cb58-526" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Convert character variables to factors (missForest expects factors, not raw character)</span></span>
<span id="cb58-527"><a href="#cb58-527" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Coerce to base data.frame to avoid tibble-related method dispatch issues</span></span>
<span id="cb58-528"><a href="#cb58-528" aria-hidden="true" tabindex="-1"></a>mf_input <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span></span>
<span id="cb58-529"><a href="#cb58-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Age, Gender, BMI, BPSysAve, Diabetes) <span class="sc">|&gt;</span></span>
<span id="cb58-530"><a href="#cb58-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), as.factor)) <span class="sc">|&gt;</span></span>
<span id="cb58-531"><a href="#cb58-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb58-532"><a href="#cb58-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-533"><a href="#cb58-533" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb58-534"><a href="#cb58-534" aria-hidden="true" tabindex="-1"></a>mf_fit <span class="ot">&lt;-</span> <span class="fu">missForest</span>(</span>
<span id="cb58-535"><a href="#cb58-535" aria-hidden="true" tabindex="-1"></a>  mf_input,</span>
<span id="cb58-536"><a href="#cb58-536" aria-hidden="true" tabindex="-1"></a>  <span class="at">ntree   =</span> <span class="dv">200</span>,    <span class="co"># more trees -&gt; stabler imputations</span></span>
<span id="cb58-537"><a href="#cb58-537" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">5</span>,      <span class="co"># outer iterations (default 10; 5 is fine for demo)</span></span>
<span id="cb58-538"><a href="#cb58-538" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb58-539"><a href="#cb58-539" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-540"><a href="#cb58-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-541"><a href="#cb58-541" aria-hidden="true" tabindex="-1"></a><span class="co"># Completed data and OOB error</span></span>
<span id="cb58-542"><a href="#cb58-542" aria-hidden="true" tabindex="-1"></a>mf_imputed <span class="ot">&lt;-</span> mf_fit<span class="sc">$</span>ximp</span>
<span id="cb58-543"><a href="#cb58-543" aria-hidden="true" tabindex="-1"></a>mf_oob     <span class="ot">&lt;-</span> mf_fit<span class="sc">$</span>OOBerror</span>
<span id="cb58-544"><a href="#cb58-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-545"><a href="#cb58-545" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick checks</span></span>
<span id="cb58-546"><a href="#cb58-546" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(mf_input<span class="sc">$</span>BMI))</span>
<span id="cb58-547"><a href="#cb58-547" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(mf_imputed<span class="sc">$</span>BMI))   <span class="co"># should go to 0</span></span>
<span id="cb58-548"><a href="#cb58-548" aria-hidden="true" tabindex="-1"></a>mf_oob</span>
<span id="cb58-549"><a href="#cb58-549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-550"><a href="#cb58-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-551"><a href="#cb58-551" aria-hidden="true" tabindex="-1"></a>The function returns a list with two key elements:</span>
<span id="cb58-552"><a href="#cb58-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-553"><a href="#cb58-553" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ximp`</span>: the completed dataset after imputation.</span>
<span id="cb58-554"><a href="#cb58-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-555"><a href="#cb58-555" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`OOBerror`</span>: the estimated imputation error (normalized root mean squared error for continuous variables and proportion of falsely classified entries for categorical variables).</span>
<span id="cb58-556"><a href="#cb58-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-557"><a href="#cb58-557" aria-hidden="true" tabindex="-1"></a>**Interpretation:**</span>
<span id="cb58-558"><a href="#cb58-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-559"><a href="#cb58-559" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The **completed dataset** (<span class="in">`ximp`</span>) replaces all missing values with imputed estimates.</span>
<span id="cb58-560"><a href="#cb58-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-561"><a href="#cb58-561" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**NRMSE (Normalized Root Mean Squared Error):** <span class="in">`0.1789`</span></span>
<span id="cb58-562"><a href="#cb58-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-563"><a href="#cb58-563" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>This value reflects the imputation error for continuous variables (e.g., <span class="in">`Age`</span>, <span class="in">`BMI`</span>, <span class="in">`BPSysAve`</span>).</span>
<span id="cb58-564"><a href="#cb58-564" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Since it is normalized, values closer to **0** indicate better accuracy. Here, an error of \~0.18 suggests that the imputed values are quite close to the true (non-missing) values.</span>
<span id="cb58-565"><a href="#cb58-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-566"><a href="#cb58-566" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**PFC (Proportion of Falsely Classified):** <span class="in">`0.0267`</span></span>
<span id="cb58-567"><a href="#cb58-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-568"><a href="#cb58-568" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>This metric evaluates categorical variables (e.g., <span class="in">`Gender`</span>, <span class="in">`Diabetes`</span>).</span>
<span id="cb58-569"><a href="#cb58-569" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A value of \~0.027 means only about **2.7% of categorical imputations were misclassified**, which is a strong performance.</span>
<span id="cb58-570"><a href="#cb58-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-571"><a href="#cb58-571" aria-hidden="true" tabindex="-1"></a>✅ **Interpretation:**\</span>
<span id="cb58-572"><a href="#cb58-572" aria-hidden="true" tabindex="-1"></a>The results indicate that <span class="in">`missForest`</span> produced high-quality imputations: continuous variables are imputed with relatively low error, and categorical variables with very low misclassification. In practical terms, this means the dataset after imputation is reliable and close to the original data distribution.</span>
<span id="cb58-573"><a href="#cb58-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-574"><a href="#cb58-574" aria-hidden="true" tabindex="-1"></a>**Pros and Cons of `missForest`**</span>
<span id="cb58-575"><a href="#cb58-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-576"><a href="#cb58-576" aria-hidden="true" tabindex="-1"></a>**Advantages:**</span>
<span id="cb58-577"><a href="#cb58-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-578"><a href="#cb58-578" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Handles mixed data types (continuous + categorical).</span>
<span id="cb58-579"><a href="#cb58-579" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Captures nonlinearities and complex interactions.</span>
<span id="cb58-580"><a href="#cb58-580" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>No need to specify an explicit imputation model.</span>
<span id="cb58-581"><a href="#cb58-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-582"><a href="#cb58-582" aria-hidden="true" tabindex="-1"></a>**Limitations:**</span>
<span id="cb58-583"><a href="#cb58-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-584"><a href="#cb58-584" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Produces only a **single imputed dataset**, so uncertainty is not directly quantified (unlike <span class="in">`mice`</span>).</span>
<span id="cb58-585"><a href="#cb58-585" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Computationally more expensive for very large datasets.</span>
<span id="cb58-586"><a href="#cb58-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-587"><a href="#cb58-587" aria-hidden="true" tabindex="-1"></a><span class="fu">## Single vs. Multiple Imputation</span></span>
<span id="cb58-588"><a href="#cb58-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-589"><a href="#cb58-589" aria-hidden="true" tabindex="-1"></a>One critical distinction in handling missing data is **single imputation** vs. **multiple imputation (MI)**.</span>
<span id="cb58-590"><a href="#cb58-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-591"><a href="#cb58-591" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Single imputation** (mean, median, regression, etc.) fills each missing value once. While simple, it **ignores uncertainty**, treating imputed values as if they were observed.</span>
<span id="cb58-592"><a href="#cb58-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-593"><a href="#cb58-593" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Multiple imputation** generates **several plausible versions of the dataset** (e.g., 5–10). Each dataset is analyzed separately, and results are then combined (pooled). This approach accounts for **variability due to missingness** and produces more reliable inferences.</span>
<span id="cb58-594"><a href="#cb58-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-595"><a href="#cb58-595" aria-hidden="true" tabindex="-1"></a>Let’s illustrate with our <span class="in">`nhanes_sub`</span> dataset:</span>
<span id="cb58-596"><a href="#cb58-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-599"><a href="#cb58-599" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-600"><a href="#cb58-600" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete-case analysis (ignores missing data)</span></span>
<span id="cb58-601"><a href="#cb58-601" aria-hidden="true" tabindex="-1"></a>lm_cc <span class="ot">&lt;-</span> <span class="fu">lm</span>(BMI <span class="sc">~</span> Age <span class="sc">+</span> Gender <span class="sc">+</span> BPSysAve <span class="sc">+</span> Diabetes,</span>
<span id="cb58-602"><a href="#cb58-602" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> nhanes_sub, <span class="at">na.action =</span> na.omit)</span>
<span id="cb58-603"><a href="#cb58-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-604"><a href="#cb58-604" aria-hidden="true" tabindex="-1"></a><span class="co"># Single imputation (mean imputation for BMI)</span></span>
<span id="cb58-605"><a href="#cb58-605" aria-hidden="true" tabindex="-1"></a>nhanes_single <span class="ot">&lt;-</span> nhanes_sub <span class="sc">|&gt;</span> </span>
<span id="cb58-606"><a href="#cb58-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BMI =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(BMI), <span class="fu">mean</span>(BMI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), BMI))</span>
<span id="cb58-607"><a href="#cb58-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-608"><a href="#cb58-608" aria-hidden="true" tabindex="-1"></a>lm_si <span class="ot">&lt;-</span> <span class="fu">lm</span>(BMI <span class="sc">~</span> Age <span class="sc">+</span> Gender <span class="sc">+</span> BPSysAve <span class="sc">+</span> Diabetes,</span>
<span id="cb58-609"><a href="#cb58-609" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> nhanes_single)</span>
<span id="cb58-610"><a href="#cb58-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-611"><a href="#cb58-611" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple imputation with mice</span></span>
<span id="cb58-612"><a href="#cb58-612" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(nhanes_sub, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">method =</span> <span class="st">"pmm"</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb58-613"><a href="#cb58-613" aria-hidden="true" tabindex="-1"></a>lm_mi <span class="ot">&lt;-</span> <span class="fu">with</span>(imp, <span class="fu">lm</span>(BMI <span class="sc">~</span> Age <span class="sc">+</span> Gender <span class="sc">+</span> BPSysAve <span class="sc">+</span> Diabetes))</span>
<span id="cb58-614"><a href="#cb58-614" aria-hidden="true" tabindex="-1"></a>pooled <span class="ot">&lt;-</span> <span class="fu">pool</span>(lm_mi)</span>
<span id="cb58-615"><a href="#cb58-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-616"><a href="#cb58-616" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-617"><a href="#cb58-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-620"><a href="#cb58-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-621"><a href="#cb58-621" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_cc)</span>
<span id="cb58-622"><a href="#cb58-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-623"><a href="#cb58-623" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_si)</span>
<span id="cb58-624"><a href="#cb58-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-625"><a href="#cb58-625" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pooled)</span>
<span id="cb58-626"><a href="#cb58-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-627"><a href="#cb58-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-628"><a href="#cb58-628" aria-hidden="true" tabindex="-1"></a>We applied three different approaches to handle missing BMI values in the <span class="in">`nhanes_sub`</span> dataset, modeling **BMI \~ Age + Gender + BPSysAve + Diabetes**. Here is what we found:</span>
<span id="cb58-629"><a href="#cb58-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-630"><a href="#cb58-630" aria-hidden="true" tabindex="-1"></a>**1. Complete-Case Analysis (CCA)**</span>
<span id="cb58-631"><a href="#cb58-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-632"><a href="#cb58-632" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**What we did:** We dropped all observations with missing values (<span class="in">`na.omit`</span>).</span>
<span id="cb58-633"><a href="#cb58-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-634"><a href="#cb58-634" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Result:**</span>
<span id="cb58-635"><a href="#cb58-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-636"><a href="#cb58-636" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Coefficients:** Age (0.048), BPSysAve (0.068), DiabetesYes (+3.79), Gender slightly negative.</span>
<span id="cb58-637"><a href="#cb58-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-638"><a href="#cb58-638" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Standard errors:** Relatively large because \~1500 observations were discarded.</span>
<span id="cb58-639"><a href="#cb58-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-640"><a href="#cb58-640" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**R²:** 0.114 — fairly low.</span>
<span id="cb58-641"><a href="#cb58-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-642"><a href="#cb58-642" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Takeaway:** CCA wastes data and may bias estimates if missingness is not MCAR (Missing Completely at Random).</span>
<span id="cb58-643"><a href="#cb58-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-644"><a href="#cb58-644" aria-hidden="true" tabindex="-1"></a>**2. Single Imputation (Mean Substitution for BMI)**</span>
<span id="cb58-645"><a href="#cb58-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-646"><a href="#cb58-646" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**What we did:** Replaced missing BMI values with the mean BMI.</span>
<span id="cb58-647"><a href="#cb58-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-648"><a href="#cb58-648" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Result:**</span>
<span id="cb58-649"><a href="#cb58-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-650"><a href="#cb58-650" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Coefficients:** Very close to CCA (Age 0.047, BPSysAve 0.067, DiabetesYes +3.73).</span>
<span id="cb58-651"><a href="#cb58-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-652"><a href="#cb58-652" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Gender** effect became just significant (*p* = 0.045).</span>
<span id="cb58-653"><a href="#cb58-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-654"><a href="#cb58-654" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Residual SE** decreased slightly (6.57).</span>
<span id="cb58-655"><a href="#cb58-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-656"><a href="#cb58-656" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Takeaway:** Looks “better” because all observations are retained, but this approach **ignores imputation uncertainty** and artificially stabilizes estimates. Standard errors are underestimated, leading to overconfidence.</span>
<span id="cb58-657"><a href="#cb58-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-658"><a href="#cb58-658" aria-hidden="true" tabindex="-1"></a>**3. Multiple Imputation (MI with `mice`, m = 5, method = "pmm")**</span>
<span id="cb58-659"><a href="#cb58-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-660"><a href="#cb58-660" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**What we did:** Generated 5 imputed datasets using Predictive Mean Matching (PMM), fit the same model in each, and pooled results.</span>
<span id="cb58-661"><a href="#cb58-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-662"><a href="#cb58-662" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Result:**</span>
<span id="cb58-663"><a href="#cb58-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-664"><a href="#cb58-664" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Coefficients:** Age effect doubled (0.104), intercept dropped (14.7 vs. \~17.5), Diabetes effect slightly smaller (+3.24), Gender effect remained modest but significant (*p* = 0.023).</span>
<span id="cb58-665"><a href="#cb58-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-666"><a href="#cb58-666" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Standard errors:** Properly adjusted upwards — reflecting real uncertainty in imputed BMI values.</span>
<span id="cb58-667"><a href="#cb58-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-668"><a href="#cb58-668" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Inference:** Despite differences in point estimates, the conclusions are more **statistically honest**.</span>
<span id="cb58-669"><a href="#cb58-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-670"><a href="#cb58-670" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Takeaway:** MI balances efficiency (uses all data) and validity (acknowledges missingness uncertainty).</span>
<span id="cb58-671"><a href="#cb58-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-672"><a href="#cb58-672" aria-hidden="true" tabindex="-1"></a>**🔑 Overall Comparison**</span>
<span id="cb58-673"><a href="#cb58-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-674"><a href="#cb58-674" aria-hidden="true" tabindex="-1"></a>| Method                   | Keeps All Data        | Coefficients Similar?         | SE Adjusted for Uncertainty? | Main Issue               |</span>
<span id="cb58-675"><a href="#cb58-675" aria-hidden="true" tabindex="-1"></a>|---------------|---------------|---------------|---------------|---------------|</span>
<span id="cb58-676"><a href="#cb58-676" aria-hidden="true" tabindex="-1"></a>| Complete Case (CCA)      | ❌ (\~1500 rows lost) | Yes, but less precise         | ✅ (but biased if MAR/MNAR)  | Data loss, possible bias |</span>
<span id="cb58-677"><a href="#cb58-677" aria-hidden="true" tabindex="-1"></a>| Single Imputation (SI)   | ✅                    | Similar to CCA                | ❌ Underestimated            | Overconfident inference  |</span>
<span id="cb58-678"><a href="#cb58-678" aria-hidden="true" tabindex="-1"></a>| Multiple Imputation (MI) | ✅                    | Somewhat different (esp. Age) | ✅ Properly adjusted         | More computation needed  |</span>
<span id="cb58-679"><a href="#cb58-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-680"><a href="#cb58-680" aria-hidden="true" tabindex="-1"></a>**Interpretation:**</span>
<span id="cb58-681"><a href="#cb58-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-682"><a href="#cb58-682" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Complete-case** drops too much data and risks bias.</span>
<span id="cb58-683"><a href="#cb58-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-684"><a href="#cb58-684" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Single imputation** keeps the data but gives *too much confidence* in results.</span>
<span id="cb58-685"><a href="#cb58-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-686"><a href="#cb58-686" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Multiple imputation** changes some coefficients (notably Age) and reports more realistic uncertaint</span>
<span id="cb58-687"><a href="#cb58-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-688"><a href="#cb58-688" aria-hidden="true" tabindex="-1"></a>👉 **Lesson:** If your goal is valid inference, especially in epidemiological or social science settings, **multiple imputation is the gold standard**.</span>
<span id="cb58-689"><a href="#cb58-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-690"><a href="#cb58-690" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison of Common Imputation Methods</span></span>
<span id="cb58-691"><a href="#cb58-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-692"><a href="#cb58-692" aria-hidden="true" tabindex="-1"></a>| Method                                          | Description                                                        | Advantages                                        | Disadvantages                                    |</span>
<span id="cb58-693"><a href="#cb58-693" aria-hidden="true" tabindex="-1"></a>|-----------------|---------------------|-----------------|-----------------|</span>
<span id="cb58-694"><a href="#cb58-694" aria-hidden="true" tabindex="-1"></a>| Listwise Deletion                               | Removes all observations containing missing values                 | Very simple, quick to implement                   | Substantial data loss, potential bias            |</span>
<span id="cb58-695"><a href="#cb58-695" aria-hidden="true" tabindex="-1"></a>| Mean / Median / Mode                            | Replaces missing values with a fixed statistic                     | Easy to apply, preserves sample size              | Reduces variance, distorts relationships         |</span>
<span id="cb58-696"><a href="#cb58-696" aria-hidden="true" tabindex="-1"></a>| LOCF (Last Observation Carried Forward)         | Uses the last available value (mainly time series)                 | Useful in longitudinal data, preserves continuity | Ignores trends, underestimates variability       |</span>
<span id="cb58-697"><a href="#cb58-697" aria-hidden="true" tabindex="-1"></a>| Linear Interpolation                            | Estimates missing values by connecting known data points           | Maintains trends, intuitive                       | Fails with sudden changes or nonlinear patterns  |</span>
<span id="cb58-698"><a href="#cb58-698" aria-hidden="true" tabindex="-1"></a>| KNN Imputation                                  | Predicts missing values using nearest neighbors                    | Preserves multivariate structure, flexible        | Computationally expensive, sensitive to k choice |</span>
<span id="cb58-699"><a href="#cb58-699" aria-hidden="true" tabindex="-1"></a>| MICE (Multiple Imputation by Chained Equations) | Iterative regression-based multiple imputation                     | Accounts for uncertainty, widely used in research | Time-consuming, requires expertise               |</span>
<span id="cb58-700"><a href="#cb58-700" aria-hidden="true" tabindex="-1"></a>| missForest                                      | Uses Random Forest to impute missing values                        | Handles nonlinearities and interactions           | Black-box method, computationally intensive      |</span>
<span id="cb58-701"><a href="#cb58-701" aria-hidden="true" tabindex="-1"></a>| EM Algorithm                                    | Iterative expectation-maximization for likelihood-based estimation | Statistically principled, robust in theory        | Requires strong assumptions, advanced knowledge  |</span>
<span id="cb58-702"><a href="#cb58-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-703"><a href="#cb58-703" aria-hidden="true" tabindex="-1"></a>No single imputation method is universally optimal—each comes with trade-offs between simplicity, accuracy, and interpretability. For instance, **listwise deletion** is tempting for its ease but can heavily bias results if missingness is not random. Simple **mean or median imputation** keeps the dataset intact but artificially reduces variability and masks true correlations. More advanced techniques such as **MICE, missForest, and EM** provide statistically sound imputations that preserve uncertainty and relationships, but they demand more computational resources and methodological expertise.</span>
<span id="cb58-704"><a href="#cb58-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-705"><a href="#cb58-705" aria-hidden="true" tabindex="-1"></a>In practice:</span>
<span id="cb58-706"><a href="#cb58-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-707"><a href="#cb58-707" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Exploratory analysis** often starts with simple methods (e.g., median replacement) to get a sense of the data.</span>
<span id="cb58-708"><a href="#cb58-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-709"><a href="#cb58-709" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Time series data** may rely on **LOCF or interpolation**.</span>
<span id="cb58-710"><a href="#cb58-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-711"><a href="#cb58-711" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Complex survey or clinical datasets** typically benefit from advanced approaches like **MICE** or **missForest**, which better respect the multivariate nature of the data.</span>
<span id="cb58-712"><a href="#cb58-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-713"><a href="#cb58-713" aria-hidden="true" tabindex="-1"></a>Ultimately, the choice depends on the **data structure, missingness mechanism (MCAR, MAR, MNAR), and analytical goals**.</span>
<span id="cb58-714"><a href="#cb58-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-715"><a href="#cb58-715" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb58-716"><a href="#cb58-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-717"><a href="#cb58-717" aria-hidden="true" tabindex="-1"></a>There is **no one-size-fits-all** solution for missing data. The right approach depends on your **goal (prediction vs. inference)**, the **missingness mechanism (MCAR/MAR/MNAR)**, your **data structure** (cross-sectional vs. longitudinal), and **practical constraints** (time, compute, expertise).</span>
<span id="cb58-718"><a href="#cb58-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-719"><a href="#cb58-719" aria-hidden="true" tabindex="-1"></a><span class="fu">### What our NHANES walkthrough showed</span></span>
<span id="cb58-720"><a href="#cb58-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-721"><a href="#cb58-721" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Complete-case analysis** is simple but wastes data and can bias results unless MCAR is plausible.</span>
<span id="cb58-722"><a href="#cb58-722" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Single imputation** (mean/median, kNN, missForest run once) keeps all rows but **underestimates uncertainty**, yielding overconfident inferences.</span>
<span id="cb58-723"><a href="#cb58-723" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Multiple imputation (MICE)** typically strikes the best balance for **inference under MAR**: it preserves multivariate structure and **propagates uncertainty** (via pooling), producing more honest standard errors and CIs.</span>
<span id="cb58-724"><a href="#cb58-724" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Nonparametric imputers** like **missForest** are strong for **predictive accuracy** on complex, nonlinear structure, but they do **not** capture imputation uncertainty by themselves.</span>
<span id="cb58-725"><a href="#cb58-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-726"><a href="#cb58-726" aria-hidden="true" tabindex="-1"></a><span class="fu">### Practical guidance (decision-oriented)</span></span>
<span id="cb58-727"><a href="#cb58-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-728"><a href="#cb58-728" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**If your main task is prediction** and interpretability is secondary → a good single-imputation engine (e.g., **missForest**) can be effective, with careful validation.</span>
<span id="cb58-729"><a href="#cb58-729" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**If your main task is inference** (effect sizes, CIs, p-values) and **MAR is reasonable** → prefer **MICE**; include strong predictors of both the outcome and missingness; check diagnostics.</span>
<span id="cb58-730"><a href="#cb58-730" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**If you suspect MNAR** → acknowledge this explicitly and consider **sensitivity analyses** (pattern-mixture/selection models) rather than assuming MAR.</span>
<span id="cb58-731"><a href="#cb58-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-732"><a href="#cb58-732" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reporting checklist (make your analysis reproducible &amp; credible)</span></span>
<span id="cb58-733"><a href="#cb58-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-734"><a href="#cb58-734" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>\% missing **by variable** and **by key subgroups** (e.g., Age, Gender).</span>
<span id="cb58-735"><a href="#cb58-735" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Your **assumed mechanism** (MCAR/MAR/MNAR) and why it’s plausible.</span>
<span id="cb58-736"><a href="#cb58-736" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The **method(s)** used (e.g., MICE with <span class="in">`pmm`</span>, <span class="in">`m`</span>, <span class="in">`maxit`</span>, <span class="in">`predictorMatrix`</span>; or missForest with <span class="in">`ntree`</span>, <span class="in">`maxiter`</span>).</span>
<span id="cb58-737"><a href="#cb58-737" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Diagnostics** (trace/density/strip plots for MICE; OOB error for missForest).</span>
<span id="cb58-738"><a href="#cb58-738" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For MI: **pooled estimates** with standard errors/intervals; clarify how pooling was performed.</span>
<span id="cb58-739"><a href="#cb58-739" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Limitations** (e.g., potential MNAR, model misspecification, small-sample caveats).</span>
<span id="cb58-740"><a href="#cb58-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-741"><a href="#cb58-741" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb58-742"><a href="#cb58-742" aria-hidden="true" tabindex="-1"></a>**Rule of thumb.** Use simple methods for quick EDA; use **MICE** for publication-grade inference under MAR; use **missForest** when you primarily need strong **predictive performance** on mixed/complex data.</span>
<span id="cb58-743"><a href="#cb58-743" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb58-744"><a href="#cb58-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-745"><a href="#cb58-745" aria-hidden="true" tabindex="-1"></a><span class="fu">### Common pitfalls to avoid</span></span>
<span id="cb58-746"><a href="#cb58-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-747"><a href="#cb58-747" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Treating imputed values as if they were observed “truth” (single imputation + significance testing).</span>
<span id="cb58-748"><a href="#cb58-748" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Imputing the **outcome** itself (generally avoid; let it *inform* predictor imputations instead).</span>
<span id="cb58-749"><a href="#cb58-749" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ignoring **leakage**: fit imputers **within** resampling folds/splits, not on the full data.</span>
<span id="cb58-750"><a href="#cb58-750" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Omitting key covariates that explain missingness (weakens the MAR assumption and the imputer).</span>
<span id="cb58-751"><a href="#cb58-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-752"><a href="#cb58-752" aria-hidden="true" tabindex="-1"></a><span class="fu">### Where to go next</span></span>
<span id="cb58-753"><a href="#cb58-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-754"><a href="#cb58-754" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Leakage-free pipelines** with <span class="in">`tidymodels::recipes`</span> (train/test split done right).</span>
<span id="cb58-755"><a href="#cb58-755" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Sensitivity analyses** for MNAR.</span>
<span id="cb58-756"><a href="#cb58-756" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Robustness checks** (alternative imputation models, different <span class="in">`m`</span>, predictor sets).</span>
<span id="cb58-757"><a href="#cb58-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-758"><a href="#cb58-758" aria-hidden="true" tabindex="-1"></a>**Bottom line:** Choose methods intentionally, **justify assumptions**, show diagnostics, and **report pooled results** when using MI. Good missing-data practice is less about one magic function and more about transparent, principled workflow.</span>
<span id="cb58-759"><a href="#cb58-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-760"><a href="#cb58-760" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
<span id="cb58-761"><a href="#cb58-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-762"><a href="#cb58-762" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Allison, P. D. (2001). *Missing Data*. Sage Publications.</span>
<span id="cb58-763"><a href="#cb58-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-764"><a href="#cb58-764" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Enders, C. K. (2010). *Applied Missing Data Analysis*. The Guilford Press.</span>
<span id="cb58-765"><a href="#cb58-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-766"><a href="#cb58-766" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Little, R. J. A., &amp; Rubin, D. B. (2002). *Statistical Analysis with Missing Data* (2nd ed.). Wiley.</span>
<span id="cb58-767"><a href="#cb58-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-768"><a href="#cb58-768" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>van Buuren, S. (2018). *Flexible Imputation of Missing Data* (2nd ed.). Chapman &amp; Hall/CRC.</span>
<span id="cb58-769"><a href="#cb58-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-770"><a href="#cb58-770" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Stekhoven, D. J., &amp; Bühlmann, P. (2012). “MissForest—Nonparametric Missing Value Imputation for Mixed-Type Data.” *Bioinformatics*, 28(1), 112–118. https://doi.org/10.1093/bioinformatics/btr597</span>
<span id="cb58-771"><a href="#cb58-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-772"><a href="#cb58-772" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rubin, D. B. (1987). *Multiple Imputation for Nonresponse in Surveys*. Wiley.</span>
<span id="cb58-773"><a href="#cb58-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-774"><a href="#cb58-774" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Schafer, J. L. (1997). *Analysis of Incomplete Multivariate Data*. Chapman &amp; Hall/CRC.</span>
<span id="cb58-775"><a href="#cb58-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-776"><a href="#cb58-776" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>R Documentation: <span class="co">[</span><span class="ot">`mice` package</span><span class="co">](https://cran.r-project.org/package=mice)</span></span>
<span id="cb58-777"><a href="#cb58-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-778"><a href="#cb58-778" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>R Documentation: <span class="co">[</span><span class="ot">`missForest` package</span><span class="co">](https://cran.r-project.org/package=missForest)</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2023, M. Fatih Tüzen</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>